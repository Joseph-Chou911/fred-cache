{
  "generated_at_utc": "2026-02-27T07:54:02Z",
  "schema_version": "v26.9",
  "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
  "inputs": {
    "cache_dir": "tw0050_bb_cache",
    "price_csv": "data.csv",
    "price_csv_resolved": "tw0050_bb_cache/data.csv",
    "stats_json": "stats_latest.json",
    "stats_json_resolved": "tw0050_bb_cache/stats_latest.json",
    "price_col": "adjclose",
    "break_ratio_hi": 1.8,
    "break_ratio_lo": 0.5555555556,
    "break_ratio_policy": "ratio_lo defaults to 1/ratio_hi (symmetric inverse) unless overridden",
    "breaks_detected": 1,
    "break_samples_first5": [
      {
        "idx": 1238,
        "break_date": "2014-01-02",
        "prev_date": "2013-12-31",
        "prev_price": 37.412410736083984,
        "price": 9.329201698303224,
        "ratio": 0.249361148205969
      }
    ],
    "break_samples_source": "detect_breaks_from_price",
    "forbid_mask_built": true,
    "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
    "gonogo_thresholds": {
      "delta_sharpe0_lt": 0.0,
      "delta_abs_mdd_gt": 0.0,
      "delta_cagr_lt": 0.01,
      "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
    },
    "maintenance_margin": 0.0,
    "maint_ratio_mode": "equity_over_lever_notional",
    "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
    "hard_fail_policy": {
      "scope": "any",
      "equity_le": 0.0,
      "any_negative_days": true
    },
    "segment_min_rows_mult": 3.0,
    "segment_post_start_default_policy": "exclude_split_day_next_row (v26.8) unless --segment_post_start_date is provided",
    "rv20_filter_policy": {
      "enabled": true,
      "scope": "bb_entry_only",
      "rv20_window": 20,
      "q_lookback": 252,
      "q": 0.6,
      "q_min_periods": 100
    },
    "equity_curve_tag": "0d3098298f",
    "equity_curve_cleanup": {
      "ok": true,
      "cache_dir": "tw0050_bb_cache",
      "removed": 37,
      "errors": []
    }
  },
  "strategy_suite": {
    "mode": "all",
    "bench_levels": [
      1.1,
      1.2,
      1.3,
      1.5
    ],
    "trend_rule": "price_gt_ma60",
    "trend_ma_fast": 20,
    "trend_ma_slow": 60,
    "omit_trades": false,
    "fail_fast": true
  },
  "strategies": [
    {
      "strategy_id": "bb_conditional",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "bb",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.024428530306281976,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.0455944356560915,
        "trades": 22,
        "skipped_entries_on_forbidden": 18,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 1,
        "skipped_entries_on_rv20": 147,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.5601199953261833,
        "open_at_end": false,
        "forced_eod_close": 0,
        "exit_count_by_exit_z": 21,
        "exit_count_by_max_hold_days": 1,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.026944928896928996,
        "exit_cost_total": 0.04157442328268812,
        "cost_paid_total": 0.06851935217961712,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.066749140044942,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08792363675306225,
          "vol_ann": 0.2771405028009066,
          "sharpe0": 0.499377366478172,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7142127067241705,
          "mdd_peak": "2011-06-01",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.12310567415740256,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.010486177311725452,
        "delta_vs_base": {
          "cagr": 0.0016587715828677574,
          "mdd": 0.0591463765091188,
          "sharpe0": -0.011456605009456222
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.024428530306281976,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.01820449628969513,
                "trades": 7,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 0,
                "skipped_entries_on_rv20": 50,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126861570698659,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 7,
                "exit_count_by_max_hold_days": 0,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.01089583734582952,
                "exit_cost_total": 0.017058790368452915,
                "cost_paid_total": 0.027954627714282438,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.953591133636018,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14616792512639054,
                "vol_ann": 0.2766766355828572,
                "sharpe0": 0.6305287820772562,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.26581913591014394,
                "mdd_peak": "2011-06-01",
                "mdd_trough": "2012-06-04",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5498773616350945,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.011308562197092083,
              "delta_vs_base": {
                "cagr": 0.01542810511118975,
                "mdd": -0.0077240204303899995,
                "sharpe0": 0.04016335746094957
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.05424366277154525,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.060819485073230484,
                "trades": 15,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 1,
                "skipped_entries_on_rv20": 97,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633755953179,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 14,
                "exit_count_by_max_hold_days": 1,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.035637080862929556,
                "exit_cost_total": 0.054437074509095504,
                "cost_paid_total": 0.09007415537202504,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.751049357606355,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2031255370887335,
                "vol_ann": 0.20814423583288663,
                "sharpe0": 0.9927222192620521,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4136535915743629,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4910522747201082,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.010145417653026716,
              "delta_vs_base": {
                "cagr": -0.0006159449227283176,
                "mdd": -0.07537717653084719,
                "sharpe0": -0.10801205845007844
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14616792512639054,
              "sharpe0": 0.6305287820772562,
              "mdd": -0.26581913591014394,
              "calmar": 0.5498773616350945
            },
            "post": {
              "cagr": 0.2031255370887335,
              "sharpe0": 0.9927222192620521,
              "mdd": -0.4136535915743629,
              "calmar": 0.4910522747201082
            },
            "delta_post_minus_pre": {
              "cagr": 0.05695761196234295,
              "sharpe0": 0.3621934371847959,
              "mdd": -0.14783445566421893,
              "calmar": -0.05882508691498628
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2031255370887335,
            "mdd": -0.4136535915743629,
            "sharpe0": 0.9927222192620521
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": -0.0006159449227283176,
            "sharpe0": -0.10801205845007844
          },
          "delta_abs_mdd": 0.07537717653084719
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": true,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__bb_conditional.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__bb_conditional.csv"
    },
    {
      "strategy_id": "always_leverage_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.004885706061256399,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.07378478912110253,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.32461664715088556,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.01717298743721381,
        "exit_cost_total": 0.026883784051392353,
        "cost_paid_total": 0.044056771488606164,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9998075,
          "end": 4.116913830260847,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08873774483187025,
          "vol_ann": 0.3150936595181085,
          "sharpe0": 0.5283454412332098,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8364447018105774,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10608919470681989,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.002472879661675753,
          "mdd": -0.06308561857728812,
          "sharpe0": 0.017511469745581598
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.004885706061256399,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.027013829245039755,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9036233838879635,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0064857044780016635,
                "exit_cost_total": 0.010068653688326573,
                "cost_paid_total": 0.016554358166328238,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 1.8573698653940451,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13447951256401858,
                "vol_ann": 0.29327500251088956,
                "sharpe0": 0.5756195470982741,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.28033081612664335,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4797171942140874,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0037396925488177857,
                "mdd": -0.0222357006468894,
                "sharpe0": -0.014745877518032469
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.01084873255430906,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.10214357250246961,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9605911020437385,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.02436507457820787,
                "exit_cost_total": 0.039318474343443224,
                "cost_paid_total": 0.0636835489216511,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 9.422951363616992,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21075673840041365,
                "vol_ann": 0.19541404314521194,
                "sharpe0": 1.0768389823274178,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35519515312224503,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5933547700406795,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.0070152563889518404,
                "mdd": -0.016918738078729345,
                "sharpe0": -0.02389529538471269
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13447951256401858,
              "sharpe0": 0.5756195470982741,
              "mdd": -0.28033081612664335,
              "calmar": 0.4797171942140874
            },
            "post": {
              "cagr": 0.21075673840041365,
              "sharpe0": 1.0768389823274178,
              "mdd": -0.35519515312224503,
              "calmar": 0.5933547700406795
            },
            "delta_post_minus_pre": {
              "cagr": 0.07627722583639507,
              "sharpe0": 0.5012194352291437,
              "mdd": -0.07486433699560169,
              "calmar": 0.11363757582659212
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21075673840041365,
            "mdd": -0.35519515312224503,
            "sharpe0": 1.0768389823274178
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.0070152563889518404,
            "sharpe0": -0.02389529538471269
          },
          "delta_abs_mdd": 0.016918738078729345
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.1x.csv"
    },
    {
      "strategy_id": "always_leverage_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.009771412122512788,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14756957824220507,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.2148440136166126,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03434597487442757,
        "exit_cost_total": 0.05376756810278462,
        "cost_paid_total": 0.08811354297721219,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9996149999999999,
          "end": 4.26907711726217,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0911266509450337,
          "vol_ann": 0.35683632432426504,
          "sharpe0": 0.55782705264344,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8953441650605286,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10177834904287693,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.0048617857748392,
          "mdd": -0.12198508182723933,
          "sharpe0": 0.0469930811558118
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.009771412122512788,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.05402765849007951,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8945606107060613,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.01297140895600331,
                "exit_cost_total": 0.02013730737665313,
                "cost_paid_total": 0.03310871633265644,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 1.8868793117930964,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1381730449836216,
                "vol_ann": 0.31738712995203605,
                "sharpe0": 0.5648965187277613,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.30109102840044166,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4589078781844531,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.007433224968420804,
                "mdd": -0.04299591292068772,
                "sharpe0": -0.025468905888545335
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.021697465108618096,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.20428714500493922,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9566188284921593,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.048730149156415686,
                "exit_cost_total": 0.07863694868688637,
                "cost_paid_total": 0.12736709784330208,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 10.042156093873665,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21736369218819473,
                "vol_ann": 0.206360745049805,
                "sharpe0": 1.0567641598392612,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.37053503670883403,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5866211576612628,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.01362221017673293,
                "mdd": -0.03225862166531834,
                "sharpe0": -0.04397011787286931
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1381730449836216,
              "sharpe0": 0.5648965187277613,
              "mdd": -0.30109102840044166,
              "calmar": 0.4589078781844531
            },
            "post": {
              "cagr": 0.21736369218819473,
              "sharpe0": 1.0567641598392612,
              "mdd": -0.37053503670883403,
              "calmar": 0.5866211576612628
            },
            "delta_post_minus_pre": {
              "cagr": 0.07919064720457314,
              "sharpe0": 0.49186764111149994,
              "mdd": -0.06944400830839237,
              "calmar": 0.12771327947680966
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21736369218819473,
            "mdd": -0.37053503670883403,
            "sharpe0": 1.0567641598392612
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.01362221017673293,
            "sharpe0": -0.04397011787286931
          },
          "delta_abs_mdd": 0.03225862166531834
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.2x.csv"
    },
    {
      "strategy_id": "always_leverage_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.014657118183769188,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.2213543673633085,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10507138008233907,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.051518962311641374,
        "exit_cost_total": 0.08065135215417694,
        "cost_paid_total": 0.1321703144658184,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9994225000000001,
          "end": 4.421240404263482,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.09343729731521067,
          "vol_ann": 0.421167258519635,
          "sharpe0": 0.6068223266621791,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9504607618820147,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09830736950170857,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.007172432145016172,
          "mdd": -0.1771016786487254,
          "sharpe0": 0.09598835517455084
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.014657118183769188,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08104148773511813,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8854978375241591,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.019457113434004976,
                "exit_cost_total": 0.030205961064979702,
                "cost_paid_total": 0.049663074498984675,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000001,
                "end": 1.9163887581921477,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14182170916345305,
                "vol_ann": 0.341324865045775,
                "sharpe0": 0.5572571222588838,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.32051789898103844,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4424767216255935,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.011081889148252255,
                "mdd": -0.062422783501284496,
                "sharpe0": -0.03310830235742279
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.03254619766292716,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.30643071750740525,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9526465549405796,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07309522373462354,
                "exit_cost_total": 0.11795542303032956,
                "cost_paid_total": 0.19105064676495312,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994224999999999,
                "end": 10.661360824130337,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.22360928211906073,
                "vol_ann": 0.21680661963766076,
                "sharpe0": 1.0396604429872716,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3845072210637204,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5815476793919673,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.01986780010759892,
                "mdd": -0.046230806020204684,
                "sharpe0": -0.061073834724858944
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14182170916345305,
              "sharpe0": 0.5572571222588838,
              "mdd": -0.32051789898103844,
              "calmar": 0.4424767216255935
            },
            "post": {
              "cagr": 0.22360928211906073,
              "sharpe0": 1.0396604429872716,
              "mdd": -0.3845072210637204,
              "calmar": 0.5815476793919673
            },
            "delta_post_minus_pre": {
              "cagr": 0.08178757295560768,
              "sharpe0": 0.48240332072838776,
              "mdd": -0.06398932208268193,
              "calmar": 0.1390709577663738
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22360928211906073,
            "mdd": -0.3845072210637204,
            "sharpe0": 1.0396604429872716
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.01986780010759892,
            "sharpe0": -0.061073834724858944
          },
          "delta_abs_mdd": 0.046230806020204684
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.3x.csv"
    },
    {
      "strategy_id": "always_leverage_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.024428530306281976,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.35963104947413754,
        "trades": 65,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 272,
        "skipped_entries_same_day_exit": 64,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 422,
        "equity_min": -0.11447388698621286,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 64,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.0853514447345085,
        "exit_cost_total": 0.1337457552150724,
        "cost_paid_total": 0.21909719994958088,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9990375,
          "end": 4.77265396271398,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.09849797324258347,
          "vol_ann": 49.293337125233144,
          "sharpe0": -0.19691267471457868,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0507151277674562,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09374374712951025,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.030743565300285988,
        "delta_vs_base": {
          "cagr": 0.012233108072388976,
          "mdd": -0.27735604453416696,
          "sharpe0": -0.7077466462022068
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.024428530306281976,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.1350691462251984,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8673722911603543,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.032428522390008284,
                "exit_cost_total": 0.05034326844163283,
                "cost_paid_total": 0.0827717908316411,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 1.975407650990245,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14898932691160582,
                "vol_ann": 0.3887777387134115,
                "sharpe0": 0.5487104670719282,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35585441653680006,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.41868056145426075,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.018249506896405032,
                "mdd": -0.09775930105704611,
                "sharpe0": -0.041654957544378424
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.05424366277154525,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.5107178625123512,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9447020078374213,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.12182537289103923,
                "exit_cost_total": 0.19659237171721594,
                "cost_paid_total": 0.3184177446082552,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 11.899770284643692,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.23516700011383396,
                "vol_ann": 0.23639548384188014,
                "sharpe0": 1.012069552634405,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4090202593383446,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5749519608008025,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.03142551810237215,
                "mdd": -0.07074384429482894,
                "sharpe0": -0.08866472507772549
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14898932691160582,
              "sharpe0": 0.5487104670719282,
              "mdd": -0.35585441653680006,
              "calmar": 0.41868056145426075
            },
            "post": {
              "cagr": 0.23516700011383396,
              "sharpe0": 1.012069552634405,
              "mdd": -0.4090202593383446,
              "calmar": 0.5749519608008025
            },
            "delta_post_minus_pre": {
              "cagr": 0.08617767320222813,
              "sharpe0": 0.46335908556247685,
              "mdd": -0.05316584280154457,
              "calmar": 0.15627139934654172
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.23516700011383396,
            "mdd": -0.4090202593383446,
            "sharpe0": 1.012069552634405
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.03142551810237215,
            "sharpe0": -0.08866472507772549
          },
          "delta_abs_mdd": 0.07074384429482894
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447388698621286)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447388698621286)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.5x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.004885706061256399,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.04954496496843135,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.2682788529043614,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.035646021714748795,
        "exit_cost_total": 0.054725312846453496,
        "cost_paid_total": 0.09037133456120228,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.016929031392505,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08711837446698012,
          "vol_ann": 0.31944587607395325,
          "sharpe0": 0.5405316937597227,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.86262559356366,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10099210493752984,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.06625357483317446,
        "delta_vs_base": {
          "cagr": 0.0008535092967856261,
          "mdd": -0.0892665103303707,
          "sharpe0": 0.02969772227209444
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.004885706061256399,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.01633451279521127,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126861570698659,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.015166092582521457,
                "exit_cost_total": 0.023118697610366345,
                "cost_paid_total": 0.0382847901928878,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7985797056092814,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1270260079296459,
                "vol_ann": 0.274896813025263,
                "sharpe0": 0.571472070966981,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2754518798113321,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4611549865502862,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.0037138120855548795,
                "mdd": -0.01735676433157818,
                "sharpe0": -0.01889335364932554
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.01084873255430906,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.07367709671580028,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633755953179,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04547677415341536,
                "exit_cost_total": 0.07107681836720256,
                "cost_paid_total": 0.11655359252061788,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 9.28898464575561,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20925981306408548,
                "vol_ann": 0.19025759832639347,
                "sharpe0": 1.0942838010061289,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.34655815659646605,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6038230786982993,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.005518331052623671,
                "mdd": -0.008281741552950361,
                "sharpe0": -0.006450476706001629
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1270260079296459,
              "sharpe0": 0.571472070966981,
              "mdd": -0.2754518798113321,
              "calmar": 0.4611549865502862
            },
            "post": {
              "cagr": 0.20925981306408548,
              "sharpe0": 1.0942838010061289,
              "mdd": -0.34655815659646605,
              "calmar": 0.6038230786982993
            },
            "delta_post_minus_pre": {
              "cagr": 0.08223380513443956,
              "sharpe0": 0.5228117300391478,
              "mdd": -0.07110627678513393,
              "calmar": 0.14266809214801313
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20925981306408548,
            "mdd": -0.34655815659646605,
            "sharpe0": 1.0942838010061289
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.005518331052623671,
            "sharpe0": -0.006450476706001629
          },
          "delta_abs_mdd": 0.008281741552950361
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.009771412122512788,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.09908992993686254,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10216842512356433,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.07129204342949748,
        "exit_cost_total": 0.1094506256929069,
        "cost_paid_total": 0.18074266912240433,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.069107519525486,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08796152591136064,
          "vol_ann": 0.3903104085073555,
          "sharpe0": 0.6108187001137666,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9486375163131335,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.0927240641433009,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.06625357483317446,
        "delta_vs_base": {
          "cagr": 0.001696660741166145,
          "mdd": -0.17527843307984425,
          "sharpe0": 0.09998472862613839
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.009771412122512788,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.03266902559042254,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126861570698659,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.030332185165042876,
                "exit_cost_total": 0.046237395220732634,
                "cost_paid_total": 0.07656958038577552,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.769298992223569,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12326373584246109,
                "vol_ann": 0.2811666179504379,
                "sharpe0": 0.5529782730371491,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.292175830006578,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4218820421924906,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.007476084172739705,
                "mdd": -0.03408071452682404,
                "sharpe0": -0.03738715157915751
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.021697465108618096,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.14735419343160056,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633755953179,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0909535483068306,
                "exit_cost_total": 0.142153636734405,
                "cost_paid_total": 0.23310718504123554,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 9.7742226581509,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2145204865387731,
                "vol_ann": 0.19685677592691658,
                "sharpe0": 1.0861566796185391,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35449806299036246,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6051386705168122,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.010779004527311287,
                "mdd": -0.016221647946846773,
                "sharpe0": -0.014577598093591382
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12326373584246109,
              "sharpe0": 0.5529782730371491,
              "mdd": -0.292175830006578,
              "calmar": 0.4218820421924906
            },
            "post": {
              "cagr": 0.2145204865387731,
              "sharpe0": 1.0861566796185391,
              "mdd": -0.35449806299036246,
              "calmar": 0.6051386705168122
            },
            "delta_post_minus_pre": {
              "cagr": 0.091256750696312,
              "sharpe0": 0.53317840658139,
              "mdd": -0.062322232983784476,
              "calmar": 0.18325662832432166
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2145204865387731,
            "mdd": -0.35449806299036246,
            "sharpe0": 1.0861566796185391
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.010779004527311287,
            "sharpe0": -0.014577598093591382
          },
          "delta_abs_mdd": 0.016221647946846773
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:02Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.014657118183769188,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14778535087380407,
        "trades": 138,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 44,
        "skipped_entries_same_day_exit": 17,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 124,
        "equity_min": -0.06394200265723271,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 17,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.10665034054956736,
        "exit_cost_total": 0.16371757025436634,
        "cost_paid_total": 0.2703679108039336,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.115641860499856,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08870494431444498,
          "vol_ann": 5.878039318504445,
          "sharpe0": -0.030062283686737145,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.031569654490961,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.08599026147024205,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.0657769304099142,
        "delta_vs_base": {
          "cagr": 0.0024400791442504843,
          "mdd": -0.25821057125767166,
          "sharpe0": -0.5408962551743653
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.014657118183769188,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.0490035383856333,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126861570698659,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04549827774756434,
                "exit_cost_total": 0.06935609283109896,
                "cost_paid_total": 0.11485437057866331,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7400182788378569,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11945155350477066,
                "vol_ann": 0.28773939910196034,
                "sharpe0": 0.5349658699634037,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3083009543397591,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.38745113118634916,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.011288266510430134,
                "mdd": -0.05020583886000518,
                "sharpe0": -0.055399554652902916
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:02Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.03254619766292716,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.22103129014740358,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633755953179,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.136430322460246,
                "exit_cost_total": 0.21323045510160762,
                "cost_paid_total": 0.34966077756185343,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 10.259460670546208,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2195474664788033,
                "vol_ann": 0.2036459312973716,
                "sharpe0": 1.076923911902215,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.36211687052974506,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6062889755940526,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.015805984467341494,
                "mdd": -0.023840455486229373,
                "sharpe0": -0.02381036580991558
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11945155350477066,
              "sharpe0": 0.5349658699634037,
              "mdd": -0.3083009543397591,
              "calmar": 0.38745113118634916
            },
            "post": {
              "cagr": 0.2195474664788033,
              "sharpe0": 1.076923911902215,
              "mdd": -0.36211687052974506,
              "calmar": 0.6062889755940526
            },
            "delta_post_minus_pre": {
              "cagr": 0.10009591297403264,
              "sharpe0": 0.5419580419388113,
              "mdd": -0.053815916189985935,
              "calmar": 0.21883784440770343
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2195474664788033,
            "mdd": -0.36211687052974506,
            "sharpe0": 1.076923911902215
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.015805984467341494,
            "sharpe0": -0.02381036580991558
          },
          "delta_abs_mdd": 0.023840455486229373
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394200265723271)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394200265723271)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-27T07:54:03Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467870712280277,
        "base_shares": 0.04885706061256395,
        "lever_shares_target": 0.024428530306281976,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.20762504788669983,
        "trades": 94,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 912,
        "skipped_entries_same_day_exit": 12,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 1422,
        "equity_min": -0.3961628582188265,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 12,
        "exit_count_by_trend_off": 81,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.1488739271888264,
        "exit_cost_total": 0.22871856518016995,
        "cost_paid_total": 0.3775924923689963,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.236809228025053,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0906042265739706,
          "vol_ann": 8.826316308755386,
          "sharpe0": -0.19396782440991286,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.1888333620394733,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647505432595227,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0862648651701945,
          "vol_ann": 0.28121537726013285,
          "sharpe0": 0.5108339714876282,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733590832332893,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.07621272204082226,
        "calmar_base_only": 0.11154568044838245,
        "turnover_proxy": 0.044804575786463297,
        "delta_vs_base": {
          "cagr": 0.00433936140377611,
          "mdd": -0.41547427880618404,
          "sharpe0": -0.7048017958975411
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467870712280277
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:03Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467870712280277,
                "base_shares": 0.04885706061256395,
                "lever_shares_target": 0.024428530306281976,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08167256397605606,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126861570698659,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07583046291260723,
                "exit_cost_total": 0.11559348805183159,
                "cost_paid_total": 0.19142395096443893,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.6814568520664328,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11167130903884415,
                "vol_ann": 0.30168217510869316,
                "sharpe0": 0.5006009346992383,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3388789292121688,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278604189949936,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398200152008,
                "vol_ann": 0.2689624655195289,
                "sharpe0": 0.5903654246163066,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809511547975394,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.32953158019726814,
              "calmar_base_only": 0.506556738868065,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.019068510976356645,
                "mdd": -0.08078381373241483,
                "sharpe0": -0.08976448991706831
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.217666625976562
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-27T07:54:03Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.217666625976562,
                "base_shares": 0.1084873255430905,
                "lever_shares_target": 0.05424366277154525,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.3683854835790021,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633755953179,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.22738387076707658,
                "exit_cost_total": 0.35538409183601255,
                "cost_paid_total": 0.5827679626030889,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 11.22993669533679,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2289805814400272,
                "vol_ann": 0.21762460026614425,
                "sharpe0": 1.0567280288771963,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.37646607422269684,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 0.9999999999999999,
                "end": 8.803746633360316,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.2037414820114618,
                "vol_ann": 0.18390522168774337,
                "sharpe0": 1.1007342777121305,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764150435157,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6082369624216782,
              "calmar_base_only": 0.6022928970240288,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.025239099428565392,
                "mdd": -0.03818965917918116,
                "sharpe0": -0.0440062488349342
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11167130903884415,
              "sharpe0": 0.5006009346992383,
              "mdd": -0.3388789292121688,
              "calmar": 0.32953158019726814
            },
            "post": {
              "cagr": 0.2289805814400272,
              "sharpe0": 1.0567280288771963,
              "mdd": -0.37646607422269684,
              "calmar": 0.6082369624216782
            },
            "delta_post_minus_pre": {
              "cagr": 0.11730927240118305,
              "sharpe0": 0.556127094177958,
              "mdd": -0.03758714501052807,
              "calmar": 0.2787053822244101
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2289805814400272,
            "mdd": -0.37646607422269684,
            "sharpe0": 1.0567280288771963
          },
          "post_base_only": {
            "cagr": 0.2037414820114618,
            "mdd": -0.3382764150435157,
            "sharpe0": 1.1007342777121305
          },
          "delta_vs_base": {
            "cagr": 0.025239099428565392,
            "sharpe0": -0.0440062488349342
          },
          "delta_abs_mdd": 0.03818965917918116
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961628582188265)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961628582188265)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv"
    }
  ],
  "compare": {
    "rows": [
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.08796152591136064,
        "full_mdd": -0.9486375163131335,
        "full_sharpe0": 0.6108187001137666,
        "full_calmar": 0.0927240641433009,
        "full_turnover_proxy": 0.06625357483317446,
        "full_delta_cagr_vs_base": 0.001696660741166145,
        "full_delta_mdd_vs_base": -0.17527843307984425,
        "full_delta_sharpe0_vs_base": 0.09998472862613839,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.2145204865387731,
        "post_mdd": -0.35449806299036246,
        "post_sharpe0": 1.0861566796185391,
        "post_calmar": 0.6051386705168122,
        "post_delta_cagr_vs_base": 0.010779004527311287,
        "post_delta_sharpe0_vs_base": -0.014577598093591382,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.08711837446698012,
        "full_mdd": -0.86262559356366,
        "full_sharpe0": 0.5405316937597227,
        "full_calmar": 0.10099210493752984,
        "full_turnover_proxy": 0.06625357483317446,
        "full_delta_cagr_vs_base": 0.0008535092967856261,
        "full_delta_mdd_vs_base": -0.0892665103303707,
        "full_delta_sharpe0_vs_base": 0.02969772227209444,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.20925981306408548,
        "post_mdd": -0.34655815659646605,
        "post_sharpe0": 1.0942838010061289,
        "post_calmar": 0.6038230786982993,
        "post_delta_cagr_vs_base": 0.005518331052623671,
        "post_delta_sharpe0_vs_base": -0.006450476706001629,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.1x",
        "entry_mode": "always",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.08873774483187025,
        "full_mdd": -0.8364447018105774,
        "full_sharpe0": 0.5283454412332098,
        "full_calmar": 0.10608919470681989,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.002472879661675753,
        "full_delta_mdd_vs_base": -0.06308561857728812,
        "full_delta_sharpe0_vs_base": 0.017511469745581598,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.21075673840041365,
        "post_mdd": -0.35519515312224503,
        "post_sharpe0": 1.0768389823274178,
        "post_calmar": 0.5933547700406795,
        "post_delta_cagr_vs_base": 0.0070152563889518404,
        "post_delta_sharpe0_vs_base": -0.02389529538471269,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.2x",
        "entry_mode": "always",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.0911266509450337,
        "full_mdd": -0.8953441650605286,
        "full_sharpe0": 0.55782705264344,
        "full_calmar": 0.10177834904287693,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.0048617857748392,
        "full_delta_mdd_vs_base": -0.12198508182723933,
        "full_delta_sharpe0_vs_base": 0.0469930811558118,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.21736369218819473,
        "post_mdd": -0.37053503670883403,
        "post_sharpe0": 1.0567641598392612,
        "post_calmar": 0.5866211576612628,
        "post_delta_cagr_vs_base": 0.01362221017673293,
        "post_delta_sharpe0_vs_base": -0.04397011787286931,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.3x",
        "entry_mode": "always",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.09343729731521067,
        "full_mdd": -0.9504607618820147,
        "full_sharpe0": 0.6068223266621791,
        "full_calmar": 0.09830736950170857,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.007172432145016172,
        "full_delta_mdd_vs_base": -0.1771016786487254,
        "full_delta_sharpe0_vs_base": 0.09598835517455084,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.22360928211906073,
        "post_mdd": -0.3845072210637204,
        "post_sharpe0": 1.0396604429872716,
        "post_calmar": 0.5815476793919673,
        "post_delta_cagr_vs_base": 0.01986780010759892,
        "post_delta_sharpe0_vs_base": -0.061073834724858944,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "bb_conditional",
        "entry_mode": "bb",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.08792363675306225,
        "full_mdd": -0.7142127067241705,
        "full_sharpe0": 0.499377366478172,
        "full_calmar": 0.12310567415740256,
        "full_turnover_proxy": 0.010486177311725452,
        "full_delta_cagr_vs_base": 0.0016587715828677574,
        "full_delta_mdd_vs_base": 0.0591463765091188,
        "full_delta_sharpe0_vs_base": -0.011456605009456222,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.2031255370887335,
        "post_mdd": -0.4136535915743629,
        "post_sharpe0": 0.9927222192620521,
        "post_calmar": 0.4910522747201082,
        "post_delta_cagr_vs_base": -0.0006159449227283176,
        "post_delta_sharpe0_vs_base": -0.10801205845007844,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.5x",
        "entry_mode": "always",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.09849797324258347,
        "full_mdd": -1.0507151277674562,
        "full_sharpe0": -0.19691267471457868,
        "full_calmar": 0.09374374712951025,
        "full_turnover_proxy": 0.030743565300285988,
        "full_delta_cagr_vs_base": 0.012233108072388976,
        "full_delta_mdd_vs_base": -0.27735604453416696,
        "full_delta_sharpe0_vs_base": -0.7077466462022068,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.23516700011383396,
        "post_mdd": -0.4090202593383446,
        "post_sharpe0": 1.012069552634405,
        "post_calmar": 0.5749519608008025,
        "post_delta_cagr_vs_base": 0.03142551810237215,
        "post_delta_sharpe0_vs_base": -0.08866472507772549,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.11447388698621286); full: equity_negative_days>0 (neg_days=422)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.08870494431444498,
        "full_mdd": -1.031569654490961,
        "full_sharpe0": -0.030062283686737145,
        "full_calmar": 0.08599026147024205,
        "full_turnover_proxy": 0.0657769304099142,
        "full_delta_cagr_vs_base": 0.0024400791442504843,
        "full_delta_mdd_vs_base": -0.25821057125767166,
        "full_delta_sharpe0_vs_base": -0.5408962551743653,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.2195474664788033,
        "post_mdd": -0.36211687052974506,
        "post_sharpe0": 1.076923911902215,
        "post_calmar": 0.6062889755940526,
        "post_delta_cagr_vs_base": 0.015805984467341494,
        "post_delta_sharpe0_vs_base": -0.02381036580991558,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.06394200265723271); full: equity_negative_days>0 (neg_days=124)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467870712280277,
        "full_cagr": 0.0906042265739706,
        "full_mdd": -1.1888333620394733,
        "full_sharpe0": -0.19396782440991286,
        "full_calmar": 0.07621272204082226,
        "full_turnover_proxy": 0.044804575786463297,
        "full_delta_cagr_vs_base": 0.00433936140377611,
        "full_delta_mdd_vs_base": -0.41547427880618404,
        "full_delta_sharpe0_vs_base": -0.7048017958975411,
        "post_ok": true,
        "post_segment_start_price": 9.217666625976562,
        "post_cagr": 0.2289805814400272,
        "post_mdd": -0.37646607422269684,
        "post_sharpe0": 1.0567280288771963,
        "post_calmar": 0.6082369624216782,
        "post_delta_cagr_vs_base": 0.025239099428565392,
        "post_delta_sharpe0_vs_base": -0.0440062488349342,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.3961628582188265); full: equity_negative_days>0 (neg_days=1422)",
        "ok": true
      }
    ],
    "ranking_policy": "prefer post (calmar desc, sharpe0 desc) when post_ok=true; else fallback to full; EXCLUDE hard_fail",
    "top3_by_policy": [
      "trend_leverage_price_gt_ma60_1.2x",
      "trend_leverage_price_gt_ma60_1.1x",
      "always_leverage_1.1x"
    ]
  },
  "failed_strategies": [],
  "suite_ok": true,
  "abort_reason": null,
  "outputs": {
    "export_strategy_id": "trend_leverage_price_gt_ma60_1.2x",
    "export_policy": "top1_by_compare_policy else first_success"
  },
  "notes": [
    "Hard-fail strategies are excluded from ranking.",
    "Maintenance margin forced close approximates margin call at EOD on trigger bar; intraday is not modeled.",
    "Maintenance ratio thresholds are NOT interchangeable across maint_ratio_mode values.",
    "JSON output is sanitized: NaN/Inf are converted to null; allow_nan=False enforced.",
    "v26.5+: RV20 entry filter is enabled for BB mode (defensive).",
    "v26.6: hard_fail scope='post' still enforces full_floor.",
    "v26.7+: write per-strategy equity curve CSV for renderer evidence.",
    "v26.8: default post_start_date excludes split_date (cut singularity day from segment stats).",
    "v26.9: cleanup old equity_curve.*.csv files in cache_dir at start of run."
  ]
}