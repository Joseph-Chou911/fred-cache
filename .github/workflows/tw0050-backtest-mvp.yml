--- a/backtest_tw0050_leverage_mvp.py
+++ b/backtest_tw0050_leverage_mvp.py
@@
-SCHEMA_VERSION = "v27.0"
-SCRIPT_FINGERPRINT = "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit"
+SCHEMA_VERSION = "v27.1"
+SCRIPT_FINGERPRINT = "backtest_tw0050_leverage_mvp@2026-02-26.v27.1.tp_sl_cli_env_enable"

@@
 def main() -> None:
-    ap = argparse.ArgumentParser()
+    def _env_truthy(name: str) -> bool:
+        v = os.getenv(name)
+        if v is None:
+            return False
+        return str(v).strip().lower() in ("1", "true", "t", "yes", "y", "on")
+
+    # If ENABLE_TP_SL=1 in env, default-enable tp/sl mode unless user explicitly disables via --no-enable-tp-sl.
+    default_enable_tp_sl = _env_truthy("ENABLE_TP_SL")
+
+    ap = argparse.ArgumentParser()

@@
-    # v27.0: optional BB tactical tp/sl strategy
+    # v27.1: tp/sl enable flags + optional BB tactical tp/sl strategy
+    _add_boolopt(
+        ap,
+        "--enable_tp_sl",
+        default=bool(default_enable_tp_sl),
+        help_text=(
+            "If set (or env ENABLE_TP_SL=1), include the BB tactical tp/sl exit strategy. "
+            "Configure thresholds via --take_profit_pct/--stop_loss_pct (or aliases)."
+        ),
+    )
+    ap.add_argument(
+        "--tp_sl",
+        dest="enable_tp_sl",
+        action="store_true",
+        default=argparse.SUPPRESS,
+        help="Alias for --enable_tp_sl.",
+    )
+
     _add_boolopt(
         ap,
         "--add_bb_tactical",
         default=False,
         help_text="If set, add an extra BB tactical strategy that exits by take-profit/stop-loss (tp/sl). Default false (no behavior change).",
     )
+    ap.add_argument(
+        "--enable_bb_tactical",
+        dest="add_bb_tactical",
+        action="store_true",
+        default=argparse.SUPPRESS,
+        help="Alias for --add_bb_tactical.",
+    )
     ap.add_argument(
-        "--take_profit_pct",
+        "--take_profit_pct",
+        "--tp_pct",
+        "--take_profit",
+        dest="take_profit_pct",
         type=float,
         default=0.0,
         help="For BB tactical strategy (tp/sl): take profit threshold as pct (e.g. 0.02 for +2%). 0 disables.",
     )
     ap.add_argument(
-        "--stop_loss_pct",
+        "--stop_loss_pct",
+        "--sl_pct",
+        "--stop_loss",
+        dest="stop_loss_pct",
         type=float,
         default=0.0,
         help="For BB tactical strategy (tp/sl): stop loss threshold as pct (e.g. 0.03 for -3%). 0 disables.",
     )

@@
     args = ap.parse_args()

@@
-    # v27.0 tactical sanity
+    # v27.1 tp/sl tactical sanity (covers --add_bb_tactical, --enable_bb_tactical, --enable_tp_sl, env ENABLE_TP_SL=1)
     tp = float(args.take_profit_pct)
     sl = float(args.stop_loss_pct)
     if tp < 0.0 or sl < 0.0:
         raise SystemExit("ERROR: --take_profit_pct and --stop_loss_pct must be >= 0")
-    if bool(getattr(args, "add_bb_tactical")):
+    enable_tp_sl = bool(getattr(args, "enable_tp_sl", False))
+    bb_tactical_requested = bool(getattr(args, "add_bb_tactical", False)) or enable_tp_sl
+    if bb_tactical_requested:
         if (tp <= 0.0 and sl <= 0.0 and int(args.max_hold_days) <= 0):
             raise SystemExit(
-                "ERROR: --add_bb_tactical set but tp/sl are both disabled and max_hold_days==0. "
+                "ERROR: tp/sl enabled but tp/sl are both disabled and max_hold_days==0. "
                 "This can create an unbounded hold. Set take_profit_pct and/or stop_loss_pct and/or max_hold_days."
             )

@@
-        # v27.0 optional tactical BB strategy: tp/sl exit
-        if bool(getattr(args, "add_bb_tactical")):
+        # v27.1 optional tactical BB strategy: tp/sl exit (enabled by --add_bb_tactical OR --enable_tp_sl OR env ENABLE_TP_SL=1)
+        if bb_tactical_requested:
             tp_bp = _fmt_bp(tp)
             sl_bp = _fmt_bp(sl)
             sid = f"bb_tactical_tp{tp_bp}bp_sl{sl_bp}bp"
             if int(args.max_hold_days) > 0:
                 sid = sid + f"_h{int(args.max_hold_days)}"
             p_tac = _make_params_from_args(
                 args=args,
                 leverage_frac=float(args.leverage_frac),
                 entry_mode="bb",
                 trend_rule=str(args.trend_rule),
                 exit_mode="tp_sl",
                 take_profit_pct=float(tp),
                 stop_loss_pct=float(sl),
             )
             strategies.append((sid, p_tac))

@@
             "bb_tactical": {
-                "enabled": bool(getattr(args, "add_bb_tactical")),
+                "enabled": bool(bb_tactical_requested),
+                "enabled_by": (
+                    "enable_tp_sl" if enable_tp_sl else (
+                        "add_bb_tactical" if bool(getattr(args, "add_bb_tactical", False)) else "none"
+                    )
+                ),
+                "env_ENABLE_TP_SL": str(os.getenv("ENABLE_TP_SL")) if os.getenv("ENABLE_TP_SL") is not None else None,
                 "take_profit_pct": float(tp),
                 "stop_loss_pct": float(sl),
                 "exit_mode": "tp_sl",
                 "note": "Only the tactical BB strategy uses tp/sl exit. Legacy bb_conditional remains z-exit.",
             },