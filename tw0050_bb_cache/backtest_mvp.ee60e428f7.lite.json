{
  "generated_at_utc": "2026-03-02T07:54:21Z",
  "schema_version": "v26.9",
  "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
  "inputs": {
    "cache_dir": "tw0050_bb_cache",
    "price_csv": "data.csv",
    "price_csv_resolved": "tw0050_bb_cache/data.csv",
    "stats_json": "stats_latest.json",
    "stats_json_resolved": "tw0050_bb_cache/stats_latest.json",
    "price_col": "adjclose",
    "break_ratio_hi": 1.8,
    "break_ratio_lo": 0.5555555556,
    "break_ratio_policy": "ratio_lo defaults to 1/ratio_hi (symmetric inverse) unless overridden",
    "breaks_detected": 1,
    "break_samples_first5": [
      {
        "idx": 1238,
        "break_date": "2014-01-02",
        "prev_date": "2013-12-31",
        "prev_price": 37.41241455078125,
        "price": 9.329201698303224,
        "ratio": 0.24936112278025666
      }
    ],
    "break_samples_source": "detect_breaks_from_price",
    "forbid_mask_built": true,
    "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
    "gonogo_thresholds": {
      "delta_sharpe0_lt": 0.0,
      "delta_abs_mdd_gt": 0.0,
      "delta_cagr_lt": 0.01,
      "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
    },
    "maintenance_margin": 0.0,
    "maint_ratio_mode": "equity_over_lever_notional",
    "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
    "hard_fail_policy": {
      "scope": "any",
      "equity_le": 0.0,
      "any_negative_days": true
    },
    "segment_min_rows_mult": 3.0,
    "segment_post_start_default_policy": "exclude_split_day_next_row (v26.8) unless --segment_post_start_date is provided",
    "rv20_filter_policy": {
      "enabled": true,
      "scope": "bb_entry_only",
      "rv20_window": 20,
      "q_lookback": 252,
      "q": 0.6,
      "q_min_periods": 100
    },
    "equity_curve_tag": "0d3098298f",
    "equity_curve_cleanup": {
      "ok": true,
      "cache_dir": "tw0050_bb_cache",
      "removed": 37,
      "errors": []
    }
  },
  "strategy_suite": {
    "mode": "all",
    "bench_levels": [
      1.1,
      1.2,
      1.3,
      1.5
    ],
    "trend_rule": "price_gt_ma60",
    "trend_ma_fast": 20,
    "trend_ma_slow": 60,
    "omit_trades": false,
    "fail_fast": true
  },
  "strategies": [
    {
      "strategy_id": "bb_conditional",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "bb",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.04559444527653091,
        "trades": 22,
        "skipped_entries_on_forbidden": 18,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 1,
        "skipped_entries_on_rv20": 147,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.560119912123599,
        "open_at_end": false,
        "forced_eod_close": 0,
        "exit_count_by_exit_z": 21,
        "exit_count_by_max_hold_days": 1,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.026944934322406452,
        "exit_cost_total": 0.0415744308948317,
        "cost_paid_total": 0.06851936521723816,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.027663835454808,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08727098947737044,
          "vol_ann": 0.27711867421672587,
          "sharpe0": 0.49721484005749866,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7142128025192793,
          "mdd_peak": "2011-06-01",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.12219185818223227,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.010483678818203479,
        "delta_vs_base": {
          "cagr": 0.0016736568179742672,
          "mdd": 0.05914625867535972,
          "sharpe0": -0.011431690275743478
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.018204500769743972,
                "trades": 7,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 0,
                "skipped_entries_on_rv20": 50,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 7,
                "exit_count_by_max_hold_days": 0,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.010895839645619253,
                "exit_cost_total": 0.017058793411497113,
                "cost_paid_total": 0.027954633057116363,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.9535914965164505,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14616796849833924,
                "vol_ann": 0.27667654541527575,
                "sharpe0": 0.630529025443536,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2658195169984924,
                "mdd_peak": "2011-06-01",
                "mdd_trough": "2012-06-04",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5498767364744261,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.011308562197092083,
              "delta_vs_base": {
                "cagr": 0.015428082063591031,
                "mdd": -0.007724425041662708,
                "sharpe0": 0.040163309738492914
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.060819504029709086,
                "trades": 15,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 1,
                "skipped_entries_on_rv20": 97,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563674981152,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 14,
                "exit_count_by_max_hold_days": 1,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.03563709222288404,
                "exit_cost_total": 0.05443709140553735,
                "cost_paid_total": 0.09007418362842139,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 8.664261699779212,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.20202886855317304,
                "vol_ann": 0.2081326739323658,
                "sharpe0": 0.9883809093919691,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4136535963370538,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4884010929486894,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.010141987829614604,
              "delta_vs_base": {
                "cagr": -0.0006213223301374526,
                "mdd": -0.07537721860657132,
                "sharpe0": -0.10744135687624334
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14616796849833924,
              "sharpe0": 0.630529025443536,
              "mdd": -0.2658195169984924,
              "calmar": 0.5498767364744261
            },
            "post": {
              "cagr": 0.20202886855317304,
              "sharpe0": 0.9883809093919691,
              "mdd": -0.4136535963370538,
              "calmar": 0.4884010929486894
            },
            "delta_post_minus_pre": {
              "cagr": 0.055860900054833795,
              "sharpe0": 0.35785188394843315,
              "mdd": -0.1478340793385614,
              "calmar": -0.061475643525736756
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20202886855317304,
            "mdd": -0.4136535963370538,
            "sharpe0": 0.9883809093919691
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": -0.0006213223301374526,
            "sharpe0": -0.10744135687624334
          },
          "delta_abs_mdd": 0.07537721860657132
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": true,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__bb_conditional.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__bb_conditional.csv"
    },
    {
      "strategy_id": "always_leverage_1.1x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.004885706971829527,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.07382765912528502,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.32461670795912,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.01717299034184146,
        "exit_cost_total": 0.02687235655933057,
        "cost_paid_total": 0.04404534690117203,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9998075,
          "end": 4.0738889751092335,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08802898130295933,
          "vol_ann": 0.3150684401305759,
          "sharpe0": 0.5262703023805748,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8364446801000583,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10524184491487112,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.03264236359304265,
        "delta_vs_base": {
          "cagr": 0.0024316486435631557,
          "mdd": -0.0630856189054193,
          "sharpe0": 0.017623772047332675
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.004885706971829527,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.027013834013120432,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.903623673506176,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.006485705650897211,
                "exit_cost_total": 0.010068655564871206,
                "cost_paid_total": 0.016554361215768417,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 1.857370416876145,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13447958118556058,
                "vol_ann": 0.29327493156543455,
                "sharpe0": 0.5756198097301256,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2803307542735354,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.47971754484825757,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0037396947508123723,
                "mdd": -0.022235662316705707,
                "sharpe0": -0.014745905974917428
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.010848735921591012,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.10224775777715488,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9605914313681561,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.024365081941593664,
                "exit_cost_total": 0.03929310043866692,
                "cost_paid_total": 0.06365818238026061,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 9.327406394607932,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.20962738922889446,
                "vol_ann": 0.1954085112665384,
                "sharpe0": 1.0720844795373612,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35519509844393804,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5901753434865623,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.03279242731575389,
              "delta_vs_base": {
                "cagr": 0.006977198345583968,
                "mdd": -0.01691872071345557,
                "sharpe0": -0.02373778673085125
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13447958118556058,
              "sharpe0": 0.5756198097301256,
              "mdd": -0.2803307542735354,
              "calmar": 0.47971754484825757
            },
            "post": {
              "cagr": 0.20962738922889446,
              "sharpe0": 1.0720844795373612,
              "mdd": -0.35519509844393804,
              "calmar": 0.5901753434865623
            },
            "delta_post_minus_pre": {
              "cagr": 0.07514780804333387,
              "sharpe0": 0.4964646698072356,
              "mdd": -0.07486434417040266,
              "calmar": 0.11045779863830474
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20962738922889446,
            "mdd": -0.35519509844393804,
            "sharpe0": 1.0720844795373612
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.006977198345583968,
            "sharpe0": -0.02373778673085125
          },
          "delta_abs_mdd": 0.01691872071345557
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.1x.csv"
    },
    {
      "strategy_id": "always_leverage_1.2x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.009771413943659043,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.1476553182505692,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.21484405427380926,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03434598068368288,
        "exit_cost_total": 0.05374471311866111,
        "cost_paid_total": 0.08809069380234398,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9996149999999999,
          "end": 4.222112472903418,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.090379330302653,
          "vol_ann": 0.3568065201019316,
          "sharpe0": 0.5558900433998603,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8953441475915681,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10094367684847103,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.03264236359304265,
        "delta_vs_base": {
          "cagr": 0.004781997643256819,
          "mdd": -0.12198508639692907,
          "sharpe0": 0.047243513066618115
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.009771413943659043,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.054027668026240865,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8945609266532022,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.012971411301794406,
                "exit_cost_total": 0.020137311129742392,
                "cost_paid_total": 0.0331087224315368,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 1.886879887715007,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.138173115755148,
                "vol_ann": 0.3173870574501937,
                "sharpe0": 0.5648967570935834,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3010909321476479,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.45890825993853296,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0074332293203998034,
                "mdd": -0.04299584019081826,
                "sharpe0": -0.02546895861145959
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.021697471843182,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.20449551555430806,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9566191877551602,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0487301638831873,
                "exit_cost_total": 0.07858620087733373,
                "cost_paid_total": 0.12731636476052105,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 9.937853641756064,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.21620009034735133,
                "vol_ann": 0.20635426761951497,
                "sharpe0": 1.0521527841503528,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.37053496586780776,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5834809404316325,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.03279242731575389,
              "delta_vs_base": {
                "cagr": 0.013549899464040838,
                "mdd": -0.032258588137325295,
                "sharpe0": -0.04366948211785959
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.138173115755148,
              "sharpe0": 0.5648967570935834,
              "mdd": -0.3010909321476479,
              "calmar": 0.45890825993853296
            },
            "post": {
              "cagr": 0.21620009034735133,
              "sharpe0": 1.0521527841503528,
              "mdd": -0.37053496586780776,
              "calmar": 0.5834809404316325
            },
            "delta_post_minus_pre": {
              "cagr": 0.07802697459220331,
              "sharpe0": 0.4872560270567694,
              "mdd": -0.06944403372015984,
              "calmar": 0.1245726804930995
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21620009034735133,
            "mdd": -0.37053496586780776,
            "sharpe0": 1.0521527841503528
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.013549899464040838,
            "sharpe0": -0.04366948211785959
          },
          "delta_abs_mdd": 0.032258588137325295
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.2x.csv"
    },
    {
      "strategy_id": "always_leverage_1.3x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.01465712091548857,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.22148297737585587,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10507140058849962,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.05151897102552434,
        "exit_cost_total": 0.08061706967799168,
        "cost_paid_total": 0.132136040703516,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9994225000000003,
          "end": 4.37033597069759,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.09265382959203738,
          "vol_ann": 0.4211295869919376,
          "sharpe0": 0.6050913751111743,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9504607518240871,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09748306746409022,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.03264236359304265,
        "delta_vs_base": {
          "cagr": 0.00705649693264121,
          "mdd": -0.17710169062944803,
          "sharpe0": 0.09644484477793214
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.01465712091548857,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.0810415020393614,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8854981798002284,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.019457116952691617,
                "exit_cost_total": 0.030205966694613593,
                "cost_paid_total": 0.0496630836473052,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000003,
                "end": 1.9163893585538707,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14182178203507956,
                "vol_ann": 0.34132479113889297,
                "sharpe0": 0.5572573395858572,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3205177717510638,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.44247712462330524,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.011081895600331348,
                "mdd": -0.062422679794234104,
                "sharpe0": -0.03310837611918582
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.03254620776477301,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.30674327333146434,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9526469441421643,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07309524582478096,
                "exit_cost_total": 0.11787930131600068,
                "cost_paid_total": 0.19097454714078166,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000001,
                "end": 10.548300888904189,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.22241462414707525,
                "vol_ann": 0.2167990661983135,
                "sharpe0": 1.0351796455268114,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.38450713515510904,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5784408241406336,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.03279242731575389,
              "delta_vs_base": {
                "cagr": 0.019764433263764758,
                "mdd": -0.04623075742462657,
                "sharpe0": -0.06064262074140103
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14182178203507956,
              "sharpe0": 0.5572573395858572,
              "mdd": -0.3205177717510638,
              "calmar": 0.44247712462330524
            },
            "post": {
              "cagr": 0.22241462414707525,
              "sharpe0": 1.0351796455268114,
              "mdd": -0.38450713515510904,
              "calmar": 0.5784408241406336
            },
            "delta_post_minus_pre": {
              "cagr": 0.08059284211199569,
              "sharpe0": 0.4779223059409542,
              "mdd": -0.06398936340404526,
              "calmar": 0.13596369951732834
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22241462414707525,
            "mdd": -0.38450713515510904,
            "sharpe0": 1.0351796455268114
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.019764433263764758,
            "sharpe0": -0.06064262074140103
          },
          "delta_abs_mdd": 0.04623075742462657
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.3x.csv"
    },
    {
      "strategy_id": "always_leverage_1.5x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.3598714969576359,
        "trades": 65,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 272,
        "skipped_entries_same_day_exit": 64,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 422,
        "equity_min": -0.11447390678212321,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 64,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.08535145992433457,
        "exit_cost_total": 0.1336886185833092,
        "cost_paid_total": 0.21904007850764376,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9990375,
          "end": 4.71384378870808,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.09765571508980209,
          "vol_ann": 49.27379570371611,
          "sharpe0": -0.19689527393737863,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0507151397212662,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09294214140257673,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.030736240171551108,
        "delta_vs_base": {
          "cagr": 0.012058382430405912,
          "mdd": -0.27735607852662714,
          "sharpe0": -0.7055418042706207
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.13506917006560248,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8673726860942803,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.03242852825448602,
                "exit_cost_total": 0.05034327782435598,
                "cost_paid_total": 0.082771806078842,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 1.9754083002315943,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1489894038416919,
                "vol_ann": 0.38877766206165326,
                "sharpe0": 0.5487106493613845,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35585423596792076,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4186809900869716,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.018249517406943694,
                "mdd": -0.09775914401109109,
                "sharpe0": -0.041655066343658564
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.5112387888857707,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9447024569161726,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.12182540970796824,
                "exit_cost_total": 0.19646550219333442,
                "cost_paid_total": 0.31829091190130276,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 11.769195383200465,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.23391798808089592,
                "vol_ann": 0.23638553376234372,
                "sharpe0": 1.0078184029234654,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4090201461980656,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5718984511037325,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.03279242731575389,
              "delta_vs_base": {
                "cagr": 0.031267797197585434,
                "mdd": -0.07074376846758312,
                "sharpe0": -0.08800386334474708
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1489894038416919,
              "sharpe0": 0.5487106493613845,
              "mdd": -0.35585423596792076,
              "calmar": 0.4186809900869716
            },
            "post": {
              "cagr": 0.23391798808089592,
              "sharpe0": 1.0078184029234654,
              "mdd": -0.4090201461980656,
              "calmar": 0.5718984511037325
            },
            "delta_post_minus_pre": {
              "cagr": 0.08492858423920402,
              "sharpe0": 0.4591077535620809,
              "mdd": -0.05316591023014483,
              "calmar": 0.15321746101676087
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.23391798808089592,
            "mdd": -0.4090201461980656,
            "sharpe0": 1.0078184029234654
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.031267797197585434,
            "sharpe0": -0.08800386334474708
          },
          "delta_abs_mdd": 0.07074376846758312
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447390678212321)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447390678212321)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.5x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.004885706971829527,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.049594475688648325,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.26827903247147533,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03564602843899723,
        "exit_cost_total": 0.05471389100672938,
        "cost_paid_total": 0.09035991944572666,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 3.9738974742574324,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08639378659523178,
          "vol_ann": 0.3194205857689495,
          "sharpe0": 0.5384320310503976,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8626254917722224,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10015213718961623,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.06623778889683107,
        "delta_vs_base": {
          "cagr": 0.000796453935835606,
          "mdd": -0.08926643057758332,
          "sharpe0": 0.029785500717155466
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.004885706971829527,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.0163345159521563,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.015166095570548183,
                "exit_cost_total": 0.02311870260054533,
                "cost_paid_total": 0.03828479817109353,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7985803753388416,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12702609342342108,
                "vol_ann": 0.27489675144662035,
                "sharpe0": 0.5714724033615777,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2754518555570937,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.461155337532631,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.0037137930113271267,
                "mdd": -0.017356763600264058,
                "sharpe0": -0.018893312343465363
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.010848735921591012,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.07378703755003398,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563674981152,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04547678806955234,
                "exit_cost_total": 0.0710514541381592,
                "cost_paid_total": 0.11652824220771159,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.193433808874817,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.20811708851874888,
                "vol_ann": 0.19025440326564658,
                "sharpe0": 1.0893257840455608,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3465580907929362,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6005258398168405,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.06220419202163624,
              "delta_vs_base": {
                "cagr": 0.005466897635438395,
                "mdd": -0.008281713062453733,
                "sharpe0": -0.006496482222651645
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12702609342342108,
              "sharpe0": 0.5714724033615777,
              "mdd": -0.2754518555570937,
              "calmar": 0.461155337532631
            },
            "post": {
              "cagr": 0.20811708851874888,
              "sharpe0": 1.0893257840455608,
              "mdd": -0.3465580907929362,
              "calmar": 0.6005258398168405
            },
            "delta_post_minus_pre": {
              "cagr": 0.0810909950953278,
              "sharpe0": 0.5178533806839831,
              "mdd": -0.07110623523584247,
              "calmar": 0.1393705022842095
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20811708851874888,
            "mdd": -0.3465580907929362,
            "sharpe0": 1.0893257840455608
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.005466897635438395,
            "sharpe0": -0.006496482222651645
          },
          "delta_abs_mdd": 0.008281713062453733
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.009771413943659043,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.09918895137729662,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.1021687032985204,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.0712920568779944,
        "exit_cost_total": 0.10942778201345867,
        "cost_paid_total": 0.1807198388914531,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.022129471199817,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08718120567288845,
          "vol_ann": 0.3902768148799463,
          "sharpe0": 0.6089497816484805,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9486373648308455,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09190150937016275,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.06623778889683107,
        "delta_vs_base": {
          "cagr": 0.0015838730134922763,
          "mdd": -0.17527830363620645,
          "sharpe0": 0.10030325131523832
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.009771413943659043,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.03266903190431258,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.030332191141096355,
                "exit_cost_total": 0.04623740520109061,
                "cost_paid_total": 0.07656959634218695,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7692998046404012,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12326384091523113,
                "vol_ann": 0.2811665643252716,
                "sharpe0": 0.5529786474514171,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2921758103274923,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4218824302294837,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.007476045519517083,
                "mdd": -0.03408071837066262,
                "sharpe0": -0.03738706825362592
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.021697471843182,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.14757407510006793,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563674981152,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.09095357613910456,
                "exit_cost_total": 0.14210290827631825,
                "cost_paid_total": 0.23305648441542284,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.669908470289835,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.21333068249551257,
                "vol_ann": 0.1968547361473243,
                "sharpe0": 1.081182928545665,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3544979696630668,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.601782522755414,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.06220419202163624,
              "delta_vs_base": {
                "cagr": 0.010680491612202081,
                "mdd": -0.016221591932584323,
                "sharpe0": -0.014639337722547552
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12326384091523113,
              "sharpe0": 0.5529786474514171,
              "mdd": -0.2921758103274923,
              "calmar": 0.4218824302294837
            },
            "post": {
              "cagr": 0.21333068249551257,
              "sharpe0": 1.081182928545665,
              "mdd": -0.3544979696630668,
              "calmar": 0.601782522755414
            },
            "delta_post_minus_pre": {
              "cagr": 0.09006684158028144,
              "sharpe0": 0.5282042810942478,
              "mdd": -0.0623221593355745,
              "calmar": 0.1799000925259303
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21333068249551257,
            "mdd": -0.3544979696630668,
            "sharpe0": 1.081182928545665
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.010680491612202081,
            "sharpe0": -0.014639337722547552
          },
          "delta_abs_mdd": 0.016221591932584323
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.01465712091548857,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.1479338829984336,
        "trades": 138,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 44,
        "skipped_entries_same_day_exit": 17,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 124,
        "equity_min": -0.06394162587443519,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 17,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.10665036072250386,
        "exit_cost_total": 0.1636833046906517,
        "cost_paid_total": 0.27033366541315534,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.064717305736513,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08786913641656957,
          "vol_ann": 5.874106474268308,
          "sharpe0": -0.030177917206503483,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.031569480332819,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.08518004661035534,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.06576125804145819,
        "delta_vs_base": {
          "cagr": 0.0022718037571733962,
          "mdd": -0.25821041913818,
          "sharpe0": -0.5388244475397457
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.01465712091548857,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.049003547856469494,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04549828671164453,
                "exit_cost_total": 0.06935610780163598,
                "cost_paid_total": 0.11485439451328049,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7400192339419605,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11945167868419504,
                "vol_ann": 0.2877393538266518,
                "sharpe0": 0.5349662871813222,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.30830094397878693,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.387451550237271,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.01128820775055317,
                "mdd": -0.050205852021957265,
                "sharpe0": -0.05539942852372082
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.03254620776477301,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.22136111265010158,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563674981152,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.13643036420865687,
                "exit_cost_total": 0.21315436241447736,
                "cost_paid_total": 0.3495847266231343,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 10.146383131704855,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2183143599745092,
                "vol_ann": 0.20364467477410245,
                "sharpe0": 1.0719575893912274,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3621167505992071,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.602883903087214,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.06220419202163624,
              "delta_vs_base": {
                "cagr": 0.01566416909119872,
                "mdd": -0.023840372868724646,
                "sharpe0": -0.023864676876985014
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11945167868419504,
              "sharpe0": 0.5349662871813222,
              "mdd": -0.30830094397878693,
              "calmar": 0.387451550237271
            },
            "post": {
              "cagr": 0.2183143599745092,
              "sharpe0": 1.0719575893912274,
              "mdd": -0.3621167505992071,
              "calmar": 0.602883903087214
            },
            "delta_post_minus_pre": {
              "cagr": 0.09886268129031417,
              "sharpe0": 0.5369913022099052,
              "mdd": -0.05381580662042018,
              "calmar": 0.21543235284994294
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2183143599745092,
            "mdd": -0.3621167505992071,
            "sharpe0": 1.0719575893912274
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.01566416909119872,
            "sharpe0": -0.023864676876985014
          },
          "delta_abs_mdd": 0.023840372868724646
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394162587443519)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394162587443519)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
      "ok": true,
      "generated_at_utc": "2026-03-02T07:54:21Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4197,
        "start_date": "2009-01-02",
        "end_date": "2026-03-02",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4138,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.20787259188835536,
        "trades": 94,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 912,
        "skipped_entries_same_day_exit": 12,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 1422,
        "equity_min": -0.3961622842203476,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 12,
        "exit_count_by_trend_off": 81,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.14887395466611533,
        "exit_cost_total": 0.22866144699853422,
        "cost_paid_total": 0.37753540166464966,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.177991851401691,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08966643368802685,
          "vol_ann": 8.822909550893728,
          "sharpe0": -0.19474715200660128,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.1888332129181514,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9256654773150492,
          "n_days": 4197,
          "years": 16.650793650793652,
          "cagr": 0.08559733265939617,
          "vol_ann": 0.2811934599801539,
          "sharpe0": 0.5086465303332421,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.07542389690470415,
        "calmar_base_only": 0.11068252375186567,
        "turnover_proxy": 0.044793900405051226,
        "delta_vs_base": {
          "cagr": 0.004069101028630673,
          "mdd": -0.4154741517235123,
          "sharpe0": -0.7033936823398435
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08167257976078213,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07583047785274086,
                "exit_cost_total": 0.11559351300272656,
                "cost_paid_total": 0.19142399085546752,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.6814580925450775,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11167147611353867,
                "vol_ann": 0.30168214760776646,
                "sharpe0": 0.5006014401596728,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3388789497500202,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896239639098596,
                "sharpe0": 0.590365715705043,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.32953205324767154,
              "calmar_base_only": 0.5065570423811718,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.01906841032120954,
                "mdd": -0.08078385779319053,
                "sharpe0": -0.08976427554537025
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2958,
              "rows_clean": 2958,
              "start_date": "2014-01-03",
              "end_date": "2026-03-02",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-03-02T07:54:21Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2958,
                "start_date": "2014-01-03",
                "end_date": "2026-03-02",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2899,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.36893518775017214,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563674981152,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.22738394034776144,
                "exit_cost_total": 0.3552572706907956,
                "cost_paid_total": 0.582641211038557,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 11.099332454534894,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.22767037224437403,
                "vol_ann": 0.2176239814650923,
                "sharpe0": 1.0518248178190526,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3764659036757273,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.716959147459796,
                "n_days": 2958,
                "years": 11.734126984126984,
                "cagr": 0.2026501908833105,
                "vol_ann": 0.18390044964201602,
                "sharpe0": 1.0958222662682124,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827637773048247,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6047569514833944,
              "calmar_base_only": 0.5990669293638042,
              "turnover_proxy": 0.06220419202163624,
              "delta_vs_base": {
                "cagr": 0.025020181361063543,
                "mdd": -0.03818952594524483,
                "sharpe0": -0.04399744844915987
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11167147611353867,
              "sharpe0": 0.5006014401596728,
              "mdd": -0.3388789497500202,
              "calmar": 0.32953205324767154
            },
            "post": {
              "cagr": 0.22767037224437403,
              "sharpe0": 1.0518248178190526,
              "mdd": -0.3764659036757273,
              "calmar": 0.6047569514833944
            },
            "delta_post_minus_pre": {
              "cagr": 0.11599889613083536,
              "sharpe0": 0.5512233776593798,
              "mdd": -0.0375869539257071,
              "calmar": 0.2752248982357228
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22767037224437403,
            "mdd": -0.3764659036757273,
            "sharpe0": 1.0518248178190526
          },
          "post_base_only": {
            "cagr": 0.2026501908833105,
            "mdd": -0.33827637773048247,
            "sharpe0": 1.0958222662682124
          },
          "delta_vs_base": {
            "cagr": 0.025020181361063543,
            "sharpe0": -0.04399744844915987
          },
          "delta_abs_mdd": 0.03818952594524483
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961622842203476)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961622842203476)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv"
    }
  ],
  "compare": {
    "rows": [
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08718120567288845,
        "full_mdd": -0.9486373648308455,
        "full_sharpe0": 0.6089497816484805,
        "full_calmar": 0.09190150937016275,
        "full_turnover_proxy": 0.06623778889683107,
        "full_delta_cagr_vs_base": 0.0015838730134922763,
        "full_delta_mdd_vs_base": -0.17527830363620645,
        "full_delta_sharpe0_vs_base": 0.10030325131523832,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.21333068249551257,
        "post_mdd": -0.3544979696630668,
        "post_sharpe0": 1.081182928545665,
        "post_calmar": 0.601782522755414,
        "post_delta_cagr_vs_base": 0.010680491612202081,
        "post_delta_sharpe0_vs_base": -0.014639337722547552,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08639378659523178,
        "full_mdd": -0.8626254917722224,
        "full_sharpe0": 0.5384320310503976,
        "full_calmar": 0.10015213718961623,
        "full_turnover_proxy": 0.06623778889683107,
        "full_delta_cagr_vs_base": 0.000796453935835606,
        "full_delta_mdd_vs_base": -0.08926643057758332,
        "full_delta_sharpe0_vs_base": 0.029785500717155466,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.20811708851874888,
        "post_mdd": -0.3465580907929362,
        "post_sharpe0": 1.0893257840455608,
        "post_calmar": 0.6005258398168405,
        "post_delta_cagr_vs_base": 0.005466897635438395,
        "post_delta_sharpe0_vs_base": -0.006496482222651645,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.1x",
        "entry_mode": "always",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08802898130295933,
        "full_mdd": -0.8364446801000583,
        "full_sharpe0": 0.5262703023805748,
        "full_calmar": 0.10524184491487112,
        "full_turnover_proxy": 0.03264236359304265,
        "full_delta_cagr_vs_base": 0.0024316486435631557,
        "full_delta_mdd_vs_base": -0.0630856189054193,
        "full_delta_sharpe0_vs_base": 0.017623772047332675,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.20962738922889446,
        "post_mdd": -0.35519509844393804,
        "post_sharpe0": 1.0720844795373612,
        "post_calmar": 0.5901753434865623,
        "post_delta_cagr_vs_base": 0.006977198345583968,
        "post_delta_sharpe0_vs_base": -0.02373778673085125,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.2x",
        "entry_mode": "always",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.090379330302653,
        "full_mdd": -0.8953441475915681,
        "full_sharpe0": 0.5558900433998603,
        "full_calmar": 0.10094367684847103,
        "full_turnover_proxy": 0.03264236359304265,
        "full_delta_cagr_vs_base": 0.004781997643256819,
        "full_delta_mdd_vs_base": -0.12198508639692907,
        "full_delta_sharpe0_vs_base": 0.047243513066618115,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.21620009034735133,
        "post_mdd": -0.37053496586780776,
        "post_sharpe0": 1.0521527841503528,
        "post_calmar": 0.5834809404316325,
        "post_delta_cagr_vs_base": 0.013549899464040838,
        "post_delta_sharpe0_vs_base": -0.04366948211785959,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.3x",
        "entry_mode": "always",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.09265382959203738,
        "full_mdd": -0.9504607518240871,
        "full_sharpe0": 0.6050913751111743,
        "full_calmar": 0.09748306746409022,
        "full_turnover_proxy": 0.03264236359304265,
        "full_delta_cagr_vs_base": 0.00705649693264121,
        "full_delta_mdd_vs_base": -0.17710169062944803,
        "full_delta_sharpe0_vs_base": 0.09644484477793214,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.22241462414707525,
        "post_mdd": -0.38450713515510904,
        "post_sharpe0": 1.0351796455268114,
        "post_calmar": 0.5784408241406336,
        "post_delta_cagr_vs_base": 0.019764433263764758,
        "post_delta_sharpe0_vs_base": -0.06064262074140103,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "bb_conditional",
        "entry_mode": "bb",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08727098947737044,
        "full_mdd": -0.7142128025192793,
        "full_sharpe0": 0.49721484005749866,
        "full_calmar": 0.12219185818223227,
        "full_turnover_proxy": 0.010483678818203479,
        "full_delta_cagr_vs_base": 0.0016736568179742672,
        "full_delta_mdd_vs_base": 0.05914625867535972,
        "full_delta_sharpe0_vs_base": -0.011431690275743478,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.20202886855317304,
        "post_mdd": -0.4136535963370538,
        "post_sharpe0": 0.9883809093919691,
        "post_calmar": 0.4884010929486894,
        "post_delta_cagr_vs_base": -0.0006213223301374526,
        "post_delta_sharpe0_vs_base": -0.10744135687624334,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.5x",
        "entry_mode": "always",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.09765571508980209,
        "full_mdd": -1.0507151397212662,
        "full_sharpe0": -0.19689527393737863,
        "full_calmar": 0.09294214140257673,
        "full_turnover_proxy": 0.030736240171551108,
        "full_delta_cagr_vs_base": 0.012058382430405912,
        "full_delta_mdd_vs_base": -0.27735607852662714,
        "full_delta_sharpe0_vs_base": -0.7055418042706207,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.23391798808089592,
        "post_mdd": -0.4090201461980656,
        "post_sharpe0": 1.0078184029234654,
        "post_calmar": 0.5718984511037325,
        "post_delta_cagr_vs_base": 0.031267797197585434,
        "post_delta_sharpe0_vs_base": -0.08800386334474708,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.11447390678212321); full: equity_negative_days>0 (neg_days=422)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08786913641656957,
        "full_mdd": -1.031569480332819,
        "full_sharpe0": -0.030177917206503483,
        "full_calmar": 0.08518004661035534,
        "full_turnover_proxy": 0.06576125804145819,
        "full_delta_cagr_vs_base": 0.0022718037571733962,
        "full_delta_mdd_vs_base": -0.25821041913818,
        "full_delta_sharpe0_vs_base": -0.5388244475397457,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.2183143599745092,
        "post_mdd": -0.3621167505992071,
        "post_sharpe0": 1.0719575893912274,
        "post_calmar": 0.602883903087214,
        "post_delta_cagr_vs_base": 0.01566416909119872,
        "post_delta_sharpe0_vs_base": -0.023864676876985014,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.06394162587443519); full: equity_negative_days>0 (neg_days=124)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08966643368802685,
        "full_mdd": -1.1888332129181514,
        "full_sharpe0": -0.19474715200660128,
        "full_calmar": 0.07542389690470415,
        "full_turnover_proxy": 0.044793900405051226,
        "full_delta_cagr_vs_base": 0.004069101028630673,
        "full_delta_mdd_vs_base": -0.4154741517235123,
        "full_delta_sharpe0_vs_base": -0.7033936823398435,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.22767037224437403,
        "post_mdd": -0.3764659036757273,
        "post_sharpe0": 1.0518248178190526,
        "post_calmar": 0.6047569514833944,
        "post_delta_cagr_vs_base": 0.025020181361063543,
        "post_delta_sharpe0_vs_base": -0.04399744844915987,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.3961622842203476); full: equity_negative_days>0 (neg_days=1422)",
        "ok": true
      }
    ],
    "ranking_policy": "prefer post (calmar desc, sharpe0 desc) when post_ok=true; else fallback to full; EXCLUDE hard_fail",
    "top3_by_policy": [
      "trend_leverage_price_gt_ma60_1.2x",
      "trend_leverage_price_gt_ma60_1.1x",
      "always_leverage_1.1x"
    ]
  },
  "failed_strategies": [],
  "suite_ok": true,
  "abort_reason": null,
  "outputs": {
    "export_strategy_id": "trend_leverage_price_gt_ma60_1.2x",
    "export_policy": "top1_by_compare_policy else first_success"
  },
  "notes": [
    "Hard-fail strategies are excluded from ranking.",
    "Maintenance margin forced close approximates margin call at EOD on trigger bar; intraday is not modeled.",
    "Maintenance ratio thresholds are NOT interchangeable across maint_ratio_mode values.",
    "JSON output is sanitized: NaN/Inf are converted to null; allow_nan=False enforced.",
    "v26.5+: RV20 entry filter is enabled for BB mode (defensive).",
    "v26.6: hard_fail scope='post' still enforces full_floor.",
    "v26.7+: write per-strategy equity curve CSV for renderer evidence.",
    "v26.8: default post_start_date excludes split_date (cut singularity day from segment stats).",
    "v26.9: cleanup old equity_curve.*.csv files in cache_dir at start of run."
  ]
}