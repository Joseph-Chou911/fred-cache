{
  "generated_at_utc": "2026-02-24T11:26:40Z",
  "schema_version": "v26.9",
  "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
  "inputs": {
    "cache_dir": "tw0050_bb_cache",
    "price_csv": "data.csv",
    "price_csv_resolved": "tw0050_bb_cache/data.csv",
    "stats_json": "stats_latest.json",
    "stats_json_resolved": "tw0050_bb_cache/stats_latest.json",
    "price_col": "adjclose",
    "break_ratio_hi": 1.8,
    "break_ratio_lo": 0.5555555556,
    "break_ratio_policy": "ratio_lo defaults to 1/ratio_hi (symmetric inverse) unless overridden",
    "breaks_detected": 1,
    "break_samples_first5": [
      {
        "idx": 1238,
        "break_date": "2014-01-02",
        "prev_date": "2013-12-31",
        "prev_price": 37.41241455078125,
        "price": 9.329200744628906,
        "ratio": 0.24936109728940478
      }
    ],
    "break_samples_source": "detect_breaks_from_price",
    "forbid_mask_built": true,
    "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
    "gonogo_thresholds": {
      "delta_sharpe0_lt": 0.0,
      "delta_abs_mdd_gt": 0.0,
      "delta_cagr_lt": 0.01,
      "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
    },
    "maintenance_margin": 0.0,
    "maint_ratio_mode": "equity_over_lever_notional",
    "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
    "hard_fail_policy": {
      "scope": "any",
      "equity_le": 0.0,
      "any_negative_days": true
    },
    "segment_min_rows_mult": 3.0,
    "segment_post_start_default_policy": "exclude_split_day_next_row (v26.8) unless --segment_post_start_date is provided",
    "rv20_filter_policy": {
      "enabled": true,
      "scope": "bb_entry_only",
      "rv20_window": 20,
      "q_lookback": 252,
      "q": 0.6,
      "q_min_periods": 100
    },
    "equity_curve_tag": "0d3098298f",
    "equity_curve_cleanup": {
      "ok": true,
      "cache_dir": "tw0050_bb_cache",
      "removed": 19,
      "errors": []
    }
  },
  "strategy_suite": {
    "mode": "all",
    "bench_levels": [
      1.1,
      1.2,
      1.3,
      1.5
    ],
    "trend_rule": "price_gt_ma60",
    "trend_ma_fast": 20,
    "trend_ma_slow": 60,
    "omit_trades": false,
    "fail_fast": true
  },
  "strategies": [
    {
      "strategy_id": "bb_conditional",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "bb",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.04559444543184316,
        "trades": 22,
        "skipped_entries_on_forbidden": 18,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 1,
        "skipped_entries_on_rv20": 147,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.56011949195685,
        "open_at_end": false,
        "forced_eod_close": 0,
        "exit_count_by_exit_z": 21,
        "exit_count_by_max_hold_days": 1,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.026944934367252926,
        "exit_cost_total": 0.0415744294638217,
        "cost_paid_total": 0.06851936383107463,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 3.9812492570221636,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08660041515025219,
          "vol_ann": 0.277209083571645,
          "sharpe0": 0.494970634291859,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7142129760084821,
          "mdd_peak": "2011-06-01",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.1212529288311666,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.010493679942761746,
        "delta_vs_base": {
          "cagr": 0.00169396938237254,
          "mdd": 0.059146131534901225,
          "sharpe0": -0.011410658682988906
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.018204501779274823,
                "trades": 7,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 0,
                "skipped_entries_on_rv20": 50,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 7,
                "exit_count_by_max_hold_days": 0,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.010895840004390995,
                "exit_cost_total": 0.017058792866350446,
                "cost_paid_total": 0.027954632870741437,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.9535911229434342,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14616792384839883,
                "vol_ann": 0.27667669825701163,
                "sharpe0": 0.6305286988542534,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2658196263518121,
                "mdd_peak": "2011-06-01",
                "mdd_trough": "2012-06-04",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5498763422944011,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.011308562197092083,
              "delta_vs_base": {
                "cagr": 0.01542803741365062,
                "mdd": -0.007724413631681859,
                "sharpe0": 0.040163080740560964
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.05424366838368067,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.060819489547948226,
                "trades": 15,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 1,
                "skipped_entries_on_rv20": 97,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633719289886,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 14,
                "exit_count_by_max_hold_days": 1,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.03563708415167137,
                "exit_cost_total": 0.054437078174178206,
                "cost_paid_total": 0.09007416232584958,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 8.561196962266937,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.20110132156163818,
                "vol_ann": 0.20819026572302857,
                "sharpe0": 0.9844543545415093,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4136535724383328,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4861587931568468,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.010155721056194989,
              "delta_vs_base": {
                "cagr": -0.000629150816813917,
                "mdd": -0.07537717605133154,
                "sharpe0": -0.10705060410859601
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14616792384839883,
              "sharpe0": 0.6305286988542534,
              "mdd": -0.2658196263518121,
              "calmar": 0.5498763422944011
            },
            "post": {
              "cagr": 0.20110132156163818,
              "sharpe0": 0.9844543545415093,
              "mdd": -0.4136535724383328,
              "calmar": 0.4861587931568468
            },
            "delta_post_minus_pre": {
              "cagr": 0.05493339771323935,
              "sharpe0": 0.35392565568725587,
              "mdd": -0.14783394608652067,
              "calmar": -0.06371754913755429
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20110132156163818,
            "mdd": -0.4136535724383328,
            "sharpe0": 0.9844543545415093
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": -0.000629150816813917,
            "sharpe0": -0.10705060410859601
          },
          "delta_abs_mdd": 0.07537717605133154
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": true,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__bb_conditional.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__bb_conditional.csv"
    },
    {
      "strategy_id": "always_leverage_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.004885706971829527,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.07365623229017523,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.32461635544709166,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.0171729911042314,
        "exit_cost_total": 0.026858780553723673,
        "cost_paid_total": 0.04403177165795508,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9998075,
          "end": 4.023018144570139,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.0872949455320069,
          "vol_ann": 0.3151732334884449,
          "sharpe0": 0.5241540533577025,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8364448637320879,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.1043642555738944,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.03267350345814453,
        "delta_vs_base": {
          "cagr": 0.00238849976412725,
          "mdd": -0.0630857561887046,
          "sharpe0": 0.01777276038285458
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.004885706971829527,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.027013836498119607,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.903623673506176,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.006485706224931995,
                "exit_cost_total": 0.010068655564871206,
                "cost_paid_total": 0.016554361789803202,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 1.8573701156172222,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13447954369957382,
                "vol_ann": 0.29327503156580825,
                "sharpe0": 0.5756196127548473,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2803309369567619,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4797170985103077,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0037396572648256132,
                "mdd": -0.02223572423663167,
                "sharpe0": -0.014746005358845182
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.010848733676736144,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.10183112018078341,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9605910980107761,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.02436507717872257,
                "exit_cost_total": 0.039262946697987286,
                "cost_paid_total": 0.06362802387670985,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 9.214482251161316,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2086822346318309,
                "vol_ann": 0.19544347807658002,
                "sharpe0": 1.067925474290087,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3551951311491407,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5875143444581975,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.032836831415030465,
              "delta_vs_base": {
                "cagr": 0.00695176225337879,
                "mdd": -0.016918734762139453,
                "sharpe0": -0.023579484360018332
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13447954369957382,
              "sharpe0": 0.5756196127548473,
              "mdd": -0.2803309369567619,
              "calmar": 0.4797170985103077
            },
            "post": {
              "cagr": 0.2086822346318309,
              "sharpe0": 1.067925474290087,
              "mdd": -0.3551951311491407,
              "calmar": 0.5875143444581975
            },
            "delta_post_minus_pre": {
              "cagr": 0.07420269093225706,
              "sharpe0": 0.4923058615352397,
              "mdd": -0.07486419419237877,
              "calmar": 0.10779724594788981
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2086822346318309,
            "mdd": -0.3551951311491407,
            "sharpe0": 1.067925474290087
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.00695176225337879,
            "sharpe0": -0.023579484360018332
          },
          "delta_abs_mdd": 0.016918734762139453
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.1x.csv"
    },
    {
      "strategy_id": "always_leverage_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.009771413943659043,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14731246458035033,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.21484339584348555,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03434598220846278,
        "exit_cost_total": 0.0537175611074473,
        "cost_paid_total": 0.08806354331591006,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9996149999999999,
          "end": 4.166784878957666,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.0896050004220521,
          "vol_ann": 0.3569307200324291,
          "sharpe0": 0.5539582935473889,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.895344466278692,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10007880072624578,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.03267350345814453,
        "delta_vs_base": {
          "cagr": 0.00469855465417246,
          "mdd": -0.12198535873530869,
          "sharpe0": 0.047577000572540995
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.009771413943659043,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.05402767299623909,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8945609266532022,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.012971412449863978,
                "exit_cost_total": 0.02013731112974239,
                "cost_paid_total": 0.03310872357960637,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 1.8868792851971625,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13817304171540923,
                "vol_ann": 0.3173871681061828,
                "sharpe0": 0.5648964803191907,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.30109117506750027,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4589076437874104,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.007433155280661019,
                "mdd": -0.04299596234737002,
                "sharpe0": -0.025469137794501773
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.021697467353472263,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.2036622403615659,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9566188240925639,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.048730154357445064,
                "exit_cost_total": 0.07852589339597447,
                "cost_paid_total": 0.1272560477534195,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 9.8150697974556,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.21523263430329864,
                "vol_ann": 0.20639352952118037,
                "sharpe0": 1.0481335486128662,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3705350106045726,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.580869899316992,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.032836831415030465,
              "delta_vs_base": {
                "cagr": 0.013502161924846545,
                "mdd": -0.03225861421757137,
                "sharpe0": -0.0433714100372391
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13817304171540923,
              "sharpe0": 0.5648964803191907,
              "mdd": -0.30109117506750027,
              "calmar": 0.4589076437874104
            },
            "post": {
              "cagr": 0.21523263430329864,
              "sharpe0": 1.0481335486128662,
              "mdd": -0.3705350106045726,
              "calmar": 0.580869899316992
            },
            "delta_post_minus_pre": {
              "cagr": 0.07705959258788941,
              "sharpe0": 0.4832370682936755,
              "mdd": -0.06944383553707234,
              "calmar": 0.12196225552958156
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21523263430329864,
            "mdd": -0.3705350106045726,
            "sharpe0": 1.0481335486128662
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.013502161924846545,
            "sharpe0": -0.0433714100372391
          },
          "delta_abs_mdd": 0.03225861421757137
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.2x.csv"
    },
    {
      "strategy_id": "always_leverage_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.01465712091548857,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.22096869687052817,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.105070436239879,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.051518973312694186,
        "exit_cost_total": 0.08057634166117096,
        "cost_paid_total": 0.1320953149738652,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9994225000000003,
          "end": 4.3105516133451856,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.09184177987599984,
          "vol_ann": 0.4212870572519489,
          "sharpe0": 0.6034329309647217,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9504612029111148,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09662864680294446,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.03267350345814453,
        "delta_vs_base": {
          "cagr": 0.006935334108120195,
          "mdd": -0.17710209536773147,
          "sharpe0": 0.09705163798987382
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.01465712091548857,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08104150949435851,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8854981798002284,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.01945711867479597,
                "exit_cost_total": 0.030205966694613593,
                "cost_paid_total": 0.049663085369409554,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000003,
                "end": 1.9163884547771022,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14182167233506915,
                "vol_ann": 0.34132491271348653,
                "sharpe0": 0.5572569984366429,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3205180731602435,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4424763662676993,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.01108178590032094,
                "mdd": -0.06242286044011325,
                "sharpe0": -0.03310861967704959
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.03254620103020841,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.3054933605423533,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9526465501743515,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07309523153616766,
                "exit_cost_total": 0.11778884009396176,
                "cost_paid_total": 0.1908840716301294,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000001,
                "end": 10.415657343749901,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.22142746746174402,
                "vol_ann": 0.2168430527249289,
                "sharpe0": 1.031285438485373,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.38450719026630553,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5758734116477399,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.032836831415030465,
              "delta_vs_base": {
                "cagr": 0.019696995083291924,
                "mdd": -0.04623079387930429,
                "sharpe0": -0.06021952016473242
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14182167233506915,
              "sharpe0": 0.5572569984366429,
              "mdd": -0.3205180731602435,
              "calmar": 0.4424763662676993
            },
            "post": {
              "cagr": 0.22142746746174402,
              "sharpe0": 1.031285438485373,
              "mdd": -0.38450719026630553,
              "calmar": 0.5758734116477399
            },
            "delta_post_minus_pre": {
              "cagr": 0.07960579512667487,
              "sharpe0": 0.47402844004873,
              "mdd": -0.06398911710606203,
              "calmar": 0.13339704538004055
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22142746746174402,
            "mdd": -0.38450719026630553,
            "sharpe0": 1.031285438485373
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.019696995083291924,
            "sharpe0": -0.06021952016473242
          },
          "delta_abs_mdd": 0.04623079387930429
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.3x.csv"
    },
    {
      "strategy_id": "always_leverage_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.35890997629330607,
        "trades": 65,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 272,
        "skipped_entries_same_day_exit": 64,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 422,
        "equity_min": -0.11447548296733157,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 64,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.08535146306358729,
        "exit_cost_total": 0.1336207366472613,
        "cost_paid_total": 0.21897219971084864,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9990375,
          "end": 4.645249990752571,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.09678641111796704,
          "vol_ann": 48.335597100792405,
          "sharpe0": -0.19590793904828055,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0507158465560882,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09211473438342256,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.030765561650369665,
        "delta_vs_base": {
          "cagr": 0.011879965350087396,
          "mdd": -0.27735673901270486,
          "sharpe0": -0.7022892320231284
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.13506918249059702,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8673726860942803,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.032428531124659946,
                "exit_cost_total": 0.05034327782435598,
                "cost_paid_total": 0.08277180894901592,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 1.9754067939369846,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14898922535738213,
                "vol_ann": 0.3887778057303738,
                "sharpe0": 0.5487102142093482,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3558546490247404,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.41868000253953075,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.018249338922633918,
                "mdd": -0.09775943630461015,
                "sharpe0": -0.0416554039043443
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.05424366838368067,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.5091556009039179,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9447020023379273,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.12182538589361276,
                "exit_cost_total": 0.19631473348993622,
                "cost_paid_total": 0.31814011938354897,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 11.616832436338488,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.23289764171401384,
                "vol_ann": 0.23643974415842892,
                "sharpe0": 1.0041402044206793,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.409020218164205,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.569403739402718,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.032836831415030465,
              "delta_vs_base": {
                "cagr": 0.03116716933556174,
                "mdd": -0.07074382177720373,
                "sharpe0": -0.08736475422942602
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14898922535738213,
              "sharpe0": 0.5487102142093482,
              "mdd": -0.3558546490247404,
              "calmar": 0.41868000253953075
            },
            "post": {
              "cagr": 0.23289764171401384,
              "sharpe0": 1.0041402044206793,
              "mdd": -0.409020218164205,
              "calmar": 0.569403739402718
            },
            "delta_post_minus_pre": {
              "cagr": 0.08390841635663171,
              "sharpe0": 0.4554299902113311,
              "mdd": -0.053165569139464575,
              "calmar": 0.1507237368631873
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.23289764171401384,
            "mdd": -0.409020218164205,
            "sharpe0": 1.0041402044206793
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.03116716933556174,
            "sharpe0": -0.08736475422942602
          },
          "delta_abs_mdd": 0.07074382177720373
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447548296733157)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447548296733157)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.5x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.004885706971829527,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.0493964698153684,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.26827853366756443,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03564602906684777,
        "exit_cost_total": 0.05470031392445783,
        "cost_paid_total": 0.09034634299130567,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 3.923052925767821,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08563896484671374,
          "vol_ann": 0.3195258688795067,
          "sharpe0": 0.5362974417189266,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8626257648977491,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09927707742054853,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.06630097782017648,
        "delta_vs_base": {
          "cagr": 0.000732519078834093,
          "mdd": -0.08926665735436579,
          "sharpe0": 0.029916148744078663
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.004885706971829527,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.01633451656822908,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.015166095947258514,
                "exit_cost_total": 0.023118701864597326,
                "cost_paid_total": 0.038284797811855856,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7985799277821737,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12702603629094633,
                "vol_ann": 0.27489686309291983,
                "sharpe0": 0.5714721081141395,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.27545203930979567,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4611548224846597,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.003713850143801878,
                "mdd": -0.01735682658966542,
                "sharpe0": -0.01889350999955297
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.010848733676736144,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.07334734807174711,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633719289886,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04547677923692531,
                "exit_cost_total": 0.07102129316016492,
                "cost_paid_total": 0.11649807239709023,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.080532368480492,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.20715292960740705,
                "vol_ann": 0.19028027932279812,
                "sharpe0": 1.085004866876592,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3465581696249216,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5977436048661262,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.06228842247799594,
              "delta_vs_base": {
                "cagr": 0.005422457228954958,
                "mdd": -0.008281773237920342,
                "sharpe0": -0.006500091773513406
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12702603629094633,
              "sharpe0": 0.5714721081141395,
              "mdd": -0.27545203930979567,
              "calmar": 0.4611548224846597
            },
            "post": {
              "cagr": 0.20715292960740705,
              "sharpe0": 1.085004866876592,
              "mdd": -0.3465581696249216,
              "calmar": 0.5977436048661262
            },
            "delta_post_minus_pre": {
              "cagr": 0.08012689331646072,
              "sharpe0": 0.5135327587624524,
              "mdd": -0.07110613031512591,
              "calmar": 0.1365887823814665
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20715292960740705,
            "mdd": -0.3465581696249216,
            "sharpe0": 1.085004866876592
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.005422457228954958,
            "sharpe0": -0.006500091773513406
          },
          "delta_abs_mdd": 0.008281773237920342
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.009771413943659043,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.0987929396307368,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10216775228443126,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.07129205813369549,
        "exit_cost_total": 0.10940062784891555,
        "cost_paid_total": 0.18069268598261112,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 3.966854441353029,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.0863638368512536,
          "vol_ann": 0.3904172151375124,
          "sharpe0": 0.6071346798746626,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9486378511165837,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09103983859551883,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.06630097782017648,
        "delta_vs_base": {
          "cagr": 0.001457391083373949,
          "mdd": -0.1752787435732004,
          "sharpe0": 0.10075338689981472
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.009771413943659043,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.03266903313645816,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.030332191894517,
                "exit_cost_total": 0.046237403729194604,
                "cost_paid_total": 0.07656959562371161,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7692989095270653,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12326372514702477,
                "vol_ann": 0.2811666998786458,
                "sharpe0": 0.5529781594179322,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.29217605373311173,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.42188168254069186,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.007476161287723437,
                "mdd": -0.03408084101298148,
                "sharpe0": -0.03738745869576032
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.021697467353472263,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.14669469614349423,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633719289886,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0909535584738505,
                "exit_cost_total": 0.14204258632032965,
                "cost_paid_total": 0.23299614479418018,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.547170032093954,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.21232625374497172,
                "vol_ann": 0.19687674459087134,
                "sharpe0": 1.0768747268850496,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3544981077162992,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.598948905856767,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.06228842247799594,
              "delta_vs_base": {
                "cagr": 0.010595781366519619,
                "mdd": -0.01622171132929795,
                "sharpe0": -0.014630231765055735
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12326372514702477,
              "sharpe0": 0.5529781594179322,
              "mdd": -0.29217605373311173,
              "calmar": 0.42188168254069186
            },
            "post": {
              "cagr": 0.21232625374497172,
              "sharpe0": 1.0768747268850496,
              "mdd": -0.3544981077162992,
              "calmar": 0.598948905856767
            },
            "delta_post_minus_pre": {
              "cagr": 0.08906252859794694,
              "sharpe0": 0.5238965674671174,
              "mdd": -0.062322053983187464,
              "calmar": 0.1770672233160751
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21232625374497172,
            "mdd": -0.3544981077162992,
            "sharpe0": 1.0768747268850496
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.010595781366519619,
            "sharpe0": -0.014630231765055735
          },
          "delta_abs_mdd": 0.01622171132929795
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.01465712091548857,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14733986528346532,
        "trades": 138,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 44,
        "skipped_entries_same_day_exit": 17,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 124,
        "equity_min": -0.0639430290987017,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 17,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.10665036252533187,
        "exit_cost_total": 0.16364257336206486,
        "cost_paid_total": 0.27029293588739667,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.005011808768305,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08698919850838904,
          "vol_ann": 5.889528890562344,
          "sharpe0": -0.030364990385922313,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0315701671756572,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.0843269816018016,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.06582399236823278,
        "delta_vs_base": {
          "cagr": 0.002082752740509397,
          "mdd": -0.25821105963227386,
          "sharpe0": -0.5367462833607702
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.01465712091548857,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.04900354970468752,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04549828784177551,
                "exit_cost_total": 0.06935610559379196,
                "cost_paid_total": 0.11485439343556746,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.740017891271957,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11945150270895577,
                "vol_ann": 0.2877395153750191,
                "sharpe0": 0.5349656116328514,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.308301243934896,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.38745060248339563,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.011288383725792439,
                "mdd": -0.050206031214765745,
                "sharpe0": -0.05540000648084109
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.03254620103020841,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.22004204421524282,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633719289886,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.13643033771077587,
                "exit_cost_total": 0.21306387948049463,
                "cost_paid_total": 0.3494942171912706,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 10.013807695707428,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.21727326411588788,
                "vol_ann": 0.20366418844966097,
                "sharpe0": 1.067674003834014,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.36211694688644147,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6000085496800125,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.06228842247799594,
              "delta_vs_base": {
                "cagr": 0.01554279173743578,
                "mdd": -0.023840550499440227,
                "sharpe0": -0.02383095481609132
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11945150270895577,
              "sharpe0": 0.5349656116328514,
              "mdd": -0.308301243934896,
              "calmar": 0.38745060248339563
            },
            "post": {
              "cagr": 0.21727326411588788,
              "sharpe0": 1.067674003834014,
              "mdd": -0.36211694688644147,
              "calmar": 0.6000085496800125
            },
            "delta_post_minus_pre": {
              "cagr": 0.0978217614069321,
              "sharpe0": 0.5327083922011626,
              "mdd": -0.053815702951545474,
              "calmar": 0.21255794719661686
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21727326411588788,
            "mdd": -0.36211694688644147,
            "sharpe0": 1.067674003834014
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.01554279173743578,
            "sharpe0": -0.02383095481609132
          },
          "delta_abs_mdd": 0.023840550499440227
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.0639430290987017)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.0639430290987017)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-24T11:26:40Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4193,
        "start_date": "2009-01-02",
        "end_date": "2026-02-24",
        "base_price_t0": 20.467866897583008,
        "base_shares": 0.048857069718295225,
        "lever_shares_target": 0.024428534859147612,
        "bb_z_non_nan": 4134,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.20688256516550318,
        "trades": 94,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 912,
        "skipped_entries_same_day_exit": 12,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 1422,
        "equity_min": -0.39616459186496916,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 12,
        "exit_count_by_trend_off": 81,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.1488739582538328,
        "exit_cost_total": 0.22859356295004296,
        "cost_paid_total": 0.3774675212038757,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.10942560599717,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08867223658078172,
          "vol_ann": 8.832075393972659,
          "sharpe0": -0.1928287257663039,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.188834266675204,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.8792514101826128,
          "n_days": 4193,
          "years": 16.634920634920636,
          "cagr": 0.08490644576787965,
          "vol_ann": 0.28128420461771747,
          "sharpe0": 0.5063812929748479,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591075433833,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.0745875510711599,
        "calmar_base_only": 0.10978915867117608,
        "turnover_proxy": 0.04483663248270928,
        "delta_vs_base": {
          "cagr": 0.00376579081290207,
          "mdd": -0.41547515913182076,
          "sharpe0": -0.6992100187411519
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467866897583008
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467866897583008,
                "base_shares": 0.048857069718295225,
                "lever_shares_target": 0.024428534859147612,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08167258284114541,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864203591499,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07583047973629252,
                "exit_cost_total": 0.11559350932298654,
                "cost_paid_total": 0.19142398905927896,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.6814558547617393,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11167117471612453,
                "vol_ann": 0.3016823676759907,
                "sharpe0": 0.5006004061083232,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3388793543368308,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278609460372823,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398864347482,
                "vol_ann": 0.26896248617315255,
                "sharpe0": 0.5903656181136925,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809521272013025,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.32953077042612755,
              "calmar_base_only": 0.5065568053620512,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.019068711718623677,
                "mdd": -0.08078414161670056,
                "sharpe0": -0.08976521200536924
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2954,
              "rows_clean": 2954,
              "start_date": "2014-01-03",
              "end_date": "2026-02-24",
              "first_price": 9.217665672302246
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-24T11:26:40Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2954,
                "start_date": "2014-01-03",
                "end_date": "2026-02-24",
                "base_price_t0": 9.217665672302246,
                "base_shares": 0.10848733676736134,
                "lever_shares_target": 0.05424366838368067,
                "bb_z_non_nan": 2895,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.3667367403587339,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645633719289886,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.2273838961846264,
                "exit_cost_total": 0.3551064658008242,
                "cost_paid_total": 0.5824903619854508,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 10.947083022934343,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.22656495469132643,
                "vol_ann": 0.21764194295367223,
                "sharpe0": 1.0476142493855898,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.37646621338392994,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.613894704867029,
                "n_days": 2954,
                "years": 11.718253968253968,
                "cagr": 0.2017304723784521,
                "vol_ann": 0.18393174501768164,
                "sharpe0": 1.0915049586501053,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827639638700124,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6018201544696646,
              "calmar_base_only": 0.5963480589631937,
              "turnover_proxy": 0.06228842247799594,
              "delta_vs_base": {
                "cagr": 0.02483448231287433,
                "mdd": -0.038189816996928694,
                "sharpe0": -0.04389070926451555
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11167117471612453,
              "sharpe0": 0.5006004061083232,
              "mdd": -0.3388793543368308,
              "calmar": 0.32953077042612755
            },
            "post": {
              "cagr": 0.22656495469132643,
              "sharpe0": 1.0476142493855898,
              "mdd": -0.37646621338392994,
              "calmar": 0.6018201544696646
            },
            "delta_post_minus_pre": {
              "cagr": 0.11489377997520189,
              "sharpe0": 0.5470138432772665,
              "mdd": -0.03758685904709913,
              "calmar": 0.2722893840435371
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22656495469132643,
            "mdd": -0.37646621338392994,
            "sharpe0": 1.0476142493855898
          },
          "post_base_only": {
            "cagr": 0.2017304723784521,
            "mdd": -0.33827639638700124,
            "sharpe0": 1.0915049586501053
          },
          "delta_vs_base": {
            "cagr": 0.02483448231287433,
            "sharpe0": -0.04389070926451555
          },
          "delta_abs_mdd": 0.038189816996928694
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.39616459186496916)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.39616459186496916)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv"
    }
  ],
  "compare": {
    "rows": [
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.0863638368512536,
        "full_mdd": -0.9486378511165837,
        "full_sharpe0": 0.6071346798746626,
        "full_calmar": 0.09103983859551883,
        "full_turnover_proxy": 0.06630097782017648,
        "full_delta_cagr_vs_base": 0.001457391083373949,
        "full_delta_mdd_vs_base": -0.1752787435732004,
        "full_delta_sharpe0_vs_base": 0.10075338689981472,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.21232625374497172,
        "post_mdd": -0.3544981077162992,
        "post_sharpe0": 1.0768747268850496,
        "post_calmar": 0.598948905856767,
        "post_delta_cagr_vs_base": 0.010595781366519619,
        "post_delta_sharpe0_vs_base": -0.014630231765055735,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08563896484671374,
        "full_mdd": -0.8626257648977491,
        "full_sharpe0": 0.5362974417189266,
        "full_calmar": 0.09927707742054853,
        "full_turnover_proxy": 0.06630097782017648,
        "full_delta_cagr_vs_base": 0.000732519078834093,
        "full_delta_mdd_vs_base": -0.08926665735436579,
        "full_delta_sharpe0_vs_base": 0.029916148744078663,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.20715292960740705,
        "post_mdd": -0.3465581696249216,
        "post_sharpe0": 1.085004866876592,
        "post_calmar": 0.5977436048661262,
        "post_delta_cagr_vs_base": 0.005422457228954958,
        "post_delta_sharpe0_vs_base": -0.006500091773513406,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.1x",
        "entry_mode": "always",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.0872949455320069,
        "full_mdd": -0.8364448637320879,
        "full_sharpe0": 0.5241540533577025,
        "full_calmar": 0.1043642555738944,
        "full_turnover_proxy": 0.03267350345814453,
        "full_delta_cagr_vs_base": 0.00238849976412725,
        "full_delta_mdd_vs_base": -0.0630857561887046,
        "full_delta_sharpe0_vs_base": 0.01777276038285458,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.2086822346318309,
        "post_mdd": -0.3551951311491407,
        "post_sharpe0": 1.067925474290087,
        "post_calmar": 0.5875143444581975,
        "post_delta_cagr_vs_base": 0.00695176225337879,
        "post_delta_sharpe0_vs_base": -0.023579484360018332,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.2x",
        "entry_mode": "always",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.0896050004220521,
        "full_mdd": -0.895344466278692,
        "full_sharpe0": 0.5539582935473889,
        "full_calmar": 0.10007880072624578,
        "full_turnover_proxy": 0.03267350345814453,
        "full_delta_cagr_vs_base": 0.00469855465417246,
        "full_delta_mdd_vs_base": -0.12198535873530869,
        "full_delta_sharpe0_vs_base": 0.047577000572540995,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.21523263430329864,
        "post_mdd": -0.3705350106045726,
        "post_sharpe0": 1.0481335486128662,
        "post_calmar": 0.580869899316992,
        "post_delta_cagr_vs_base": 0.013502161924846545,
        "post_delta_sharpe0_vs_base": -0.0433714100372391,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.3x",
        "entry_mode": "always",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.09184177987599984,
        "full_mdd": -0.9504612029111148,
        "full_sharpe0": 0.6034329309647217,
        "full_calmar": 0.09662864680294446,
        "full_turnover_proxy": 0.03267350345814453,
        "full_delta_cagr_vs_base": 0.006935334108120195,
        "full_delta_mdd_vs_base": -0.17710209536773147,
        "full_delta_sharpe0_vs_base": 0.09705163798987382,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.22142746746174402,
        "post_mdd": -0.38450719026630553,
        "post_sharpe0": 1.031285438485373,
        "post_calmar": 0.5758734116477399,
        "post_delta_cagr_vs_base": 0.019696995083291924,
        "post_delta_sharpe0_vs_base": -0.06021952016473242,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "bb_conditional",
        "entry_mode": "bb",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08660041515025219,
        "full_mdd": -0.7142129760084821,
        "full_sharpe0": 0.494970634291859,
        "full_calmar": 0.1212529288311666,
        "full_turnover_proxy": 0.010493679942761746,
        "full_delta_cagr_vs_base": 0.00169396938237254,
        "full_delta_mdd_vs_base": 0.059146131534901225,
        "full_delta_sharpe0_vs_base": -0.011410658682988906,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.20110132156163818,
        "post_mdd": -0.4136535724383328,
        "post_sharpe0": 0.9844543545415093,
        "post_calmar": 0.4861587931568468,
        "post_delta_cagr_vs_base": -0.000629150816813917,
        "post_delta_sharpe0_vs_base": -0.10705060410859601,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.5x",
        "entry_mode": "always",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.09678641111796704,
        "full_mdd": -1.0507158465560882,
        "full_sharpe0": -0.19590793904828055,
        "full_calmar": 0.09211473438342256,
        "full_turnover_proxy": 0.030765561650369665,
        "full_delta_cagr_vs_base": 0.011879965350087396,
        "full_delta_mdd_vs_base": -0.27735673901270486,
        "full_delta_sharpe0_vs_base": -0.7022892320231284,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.23289764171401384,
        "post_mdd": -0.409020218164205,
        "post_sharpe0": 1.0041402044206793,
        "post_calmar": 0.569403739402718,
        "post_delta_cagr_vs_base": 0.03116716933556174,
        "post_delta_sharpe0_vs_base": -0.08736475422942602,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.11447548296733157); full: equity_negative_days>0 (neg_days=422)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08698919850838904,
        "full_mdd": -1.0315701671756572,
        "full_sharpe0": -0.030364990385922313,
        "full_calmar": 0.0843269816018016,
        "full_turnover_proxy": 0.06582399236823278,
        "full_delta_cagr_vs_base": 0.002082752740509397,
        "full_delta_mdd_vs_base": -0.25821105963227386,
        "full_delta_sharpe0_vs_base": -0.5367462833607702,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.21727326411588788,
        "post_mdd": -0.36211694688644147,
        "post_sharpe0": 1.067674003834014,
        "post_calmar": 0.6000085496800125,
        "post_delta_cagr_vs_base": 0.01554279173743578,
        "post_delta_sharpe0_vs_base": -0.02383095481609132,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.0639430290987017); full: equity_negative_days>0 (neg_days=124)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467866897583008,
        "full_cagr": 0.08867223658078172,
        "full_mdd": -1.188834266675204,
        "full_sharpe0": -0.1928287257663039,
        "full_calmar": 0.0745875510711599,
        "full_turnover_proxy": 0.04483663248270928,
        "full_delta_cagr_vs_base": 0.00376579081290207,
        "full_delta_mdd_vs_base": -0.41547515913182076,
        "full_delta_sharpe0_vs_base": -0.6992100187411519,
        "post_ok": true,
        "post_segment_start_price": 9.217665672302246,
        "post_cagr": 0.22656495469132643,
        "post_mdd": -0.37646621338392994,
        "post_sharpe0": 1.0476142493855898,
        "post_calmar": 0.6018201544696646,
        "post_delta_cagr_vs_base": 0.02483448231287433,
        "post_delta_sharpe0_vs_base": -0.04389070926451555,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.39616459186496916); full: equity_negative_days>0 (neg_days=1422)",
        "ok": true
      }
    ],
    "ranking_policy": "prefer post (calmar desc, sharpe0 desc) when post_ok=true; else fallback to full; EXCLUDE hard_fail",
    "top3_by_policy": [
      "trend_leverage_price_gt_ma60_1.2x",
      "trend_leverage_price_gt_ma60_1.1x",
      "always_leverage_1.1x"
    ]
  },
  "failed_strategies": [],
  "suite_ok": true,
  "abort_reason": null,
  "outputs": {
    "export_strategy_id": "trend_leverage_price_gt_ma60_1.2x",
    "export_policy": "top1_by_compare_policy else first_success"
  },
  "notes": [
    "Hard-fail strategies are excluded from ranking.",
    "Maintenance margin forced close approximates margin call at EOD on trigger bar; intraday is not modeled.",
    "Maintenance ratio thresholds are NOT interchangeable across maint_ratio_mode values.",
    "JSON output is sanitized: NaN/Inf are converted to null; allow_nan=False enforced.",
    "v26.5+: RV20 entry filter is enabled for BB mode (defensive).",
    "v26.6: hard_fail scope='post' still enforces full_floor.",
    "v26.7+: write per-strategy equity curve CSV for renderer evidence.",
    "v26.8: default post_start_date excludes split_date (cut singularity day from segment stats).",
    "v26.9: cleanup old equity_curve.*.csv files in cache_dir at start of run."
  ]
}