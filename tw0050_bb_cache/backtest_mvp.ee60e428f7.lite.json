{
  "generated_at_utc": "2026-02-26T06:35:10Z",
  "schema_version": "v27.0",
  "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
  "inputs": {
    "cache_dir": "tw0050_bb_cache",
    "price_csv": "data.csv",
    "price_csv_resolved": "tw0050_bb_cache/data.csv",
    "stats_json": "stats_latest.json",
    "stats_json_resolved": "tw0050_bb_cache/stats_latest.json",
    "price_col": "adjclose",
    "break_ratio_hi": 1.8,
    "break_ratio_lo": 0.5555555556,
    "break_ratio_policy": "ratio_lo defaults to 1/ratio_hi (symmetric inverse) unless overridden",
    "breaks_detected": 1,
    "break_samples_first5": [
      {
        "idx": 1238,
        "break_date": "2014-01-02",
        "prev_date": "2013-12-31",
        "prev_price": 37.412410736083984,
        "price": 9.329201698303224,
        "ratio": 0.249361148205969
      }
    ],
    "break_samples_source": "detect_breaks_from_price",
    "forbid_mask_built": true,
    "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
    "gonogo_thresholds": {
      "delta_sharpe0_lt": 0.0,
      "delta_abs_mdd_gt": 0.0,
      "delta_cagr_lt": 0.01,
      "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
    },
    "maintenance_margin": 0.0,
    "maint_ratio_mode": "equity_over_lever_notional",
    "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
    "hard_fail_policy": {
      "scope": "any",
      "equity_le": 0.0,
      "any_negative_days": true
    },
    "segment_min_rows_mult": 3.0,
    "segment_post_start_default_policy": "exclude_split_day_next_row (v26.8) unless --segment_post_start_date is provided",
    "rv20_filter_policy": {
      "enabled": true,
      "scope": "bb_entry_only",
      "rv20_window": 20,
      "q_lookback": 252,
      "q": 0.6,
      "q_min_periods": 100
    },
    "equity_curve_tag": "e49ef1f199",
    "equity_curve_cleanup": {
      "ok": true,
      "cache_dir": "tw0050_bb_cache",
      "removed": 37,
      "errors": []
    },
    "bb_tactical": {
      "enabled": false,
      "take_profit_pct": 0.0,
      "stop_loss_pct": 0.0,
      "exit_mode": "tp_sl",
      "note": "Only the tactical BB strategy uses tp/sl exit. Legacy bb_conditional remains z-exit."
    }
  },
  "strategy_suite": {
    "mode": "all",
    "bench_levels": [
      1.1,
      1.2,
      1.3,
      1.5
    ],
    "trend_rule": "price_gt_ma60",
    "trend_ma_fast": 20,
    "trend_ma_slow": 60,
    "omit_trades": false,
    "fail_fast": true
  },
  "strategies": [
    {
      "strategy_id": "bb_conditional",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:10Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "bb",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.024428532582714584,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.045594439924335026,
        "trades": 22,
        "skipped_entries_on_forbidden": 18,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 1,
        "skipped_entries_on_rv20": 147,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.5601201395443073,
        "open_at_end": false,
        "forced_eod_close": 0,
        "exit_count_by_exit_z": 21,
        "exit_count_by_max_hold_days": 1,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 0,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.026944931049086684,
        "exit_cost_total": 0.04157442756576286,
        "cost_paid_total": 0.06851935861484953,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.072124152089728,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.0880318427562059,
          "vol_ann": 0.277182601324008,
          "sharpe0": 0.4997159275513603,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7142125780438311,
          "mdd_peak": "2011-06-01",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.12325720025446459,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.010488676996424315,
        "delta_vs_base": {
          "cagr": 0.0016571207656599363,
          "mdd": 0.05914655153819581,
          "sharpe0": -0.01146065223908721
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:10Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.024428532582714584,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.018204498516776642,
                "trades": 7,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 0,
                "skipped_entries_on_rv20": 50,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126862421207675,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 7,
                "exit_count_by_max_hold_days": 0,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.010895838450877816,
                "exit_cost_total": 0.017058792503264822,
                "cost_paid_total": 0.02795463095414264,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.9535914543019015,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14616796345280103,
                "vol_ann": 0.2766766942655872,
                "sharpe0": 0.6305288193130284,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2658193786044247,
                "mdd_peak": "2011-06-01",
                "mdd_trough": "2012-06-04",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5498770037767592,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.011308562197092083,
              "delta_vs_base": {
                "cagr": 0.015428121971607922,
                "mdd": -0.007724190981567625,
                "sharpe0": 0.040163363922765205
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:10Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.060819502815472215,
                "trades": 15,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 1,
                "skipped_entries_on_rv20": 97,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563571519544,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 14,
                "exit_count_by_max_hold_days": 1,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.035637090928320674,
                "exit_cost_total": 0.054437091102912144,
                "cost_paid_total": 0.09007418203123278,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 8.762986165808535,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20334070506306867,
                "vol_ann": 0.20819748813981911,
                "sharpe0": 0.9933807363072803,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4136534658472093,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.49157258877694593,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.010148849797023005,
              "delta_vs_base": {
                "cagr": -0.0006154217858496125,
                "mdd": -0.07537714579698607,
                "sharpe0": -0.10806748483785567
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14616796345280103,
              "sharpe0": 0.6305288193130284,
              "mdd": -0.2658193786044247,
              "calmar": 0.5498770037767592
            },
            "post": {
              "cagr": 0.20334070506306867,
              "sharpe0": 0.9933807363072803,
              "mdd": -0.4136534658472093,
              "calmar": 0.49157258877694593
            },
            "delta_post_minus_pre": {
              "cagr": 0.05717274161026764,
              "sharpe0": 0.3628519169942519,
              "mdd": -0.14783408724278457,
              "calmar": -0.05830441499981326
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20334070506306867,
            "mdd": -0.4136534658472093,
            "sharpe0": 0.9933807363072803
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": -0.0006154217858496125,
            "sharpe0": -0.10806748483785567
          },
          "delta_abs_mdd": 0.07537714579698607
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": true,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__bb_conditional.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__bb_conditional.csv"
    },
    {
      "strategy_id": "always_leverage_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.004885706516542921,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.07374193916594539,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.32461639183301705,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.017172989198968095,
        "exit_cost_total": 0.026885358309730528,
        "cost_paid_total": 0.044058347508698616,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9998075,
          "end": 4.122867073430948,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08885435014957133,
          "vol_ann": 0.3151393520046127,
          "sharpe0": 0.5286785358334825,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8364448578675947,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10622858077709237,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.03265792610250298,
        "delta_vs_base": {
          "cagr": 0.00247962815902536,
          "mdd": -0.0630857282855678,
          "sharpe0": 0.01750195604303495
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.004885706516542921,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.027013833116196127,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9036234774439553,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.006485705369405334,
                "exit_cost_total": 0.010068654381282825,
                "cost_paid_total": 0.016554359750688155,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 1.8573698041134694,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13447950493880612,
                "vol_ann": 0.2932750360240556,
                "sharpe0": 0.5756194800292718,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.28033090322707666,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.47971701796242416,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0037396634576130072,
                "mdd": -0.022235715604219553,
                "sharpe0": -0.014745975360991426
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.010848735921591012,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.1020394487386185,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9605913175603871,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.024365081901760954,
                "exit_cost_total": 0.03932197705666421,
                "cost_paid_total": 0.06368705895842516,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 9.436182089972938,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.21097999283142777,
                "vol_ann": 0.19546428917718892,
                "sharpe0": 1.077556112270354,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.35519507221988833,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.593983445527132,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.032814614343707714,
              "delta_vs_base": {
                "cagr": 0.007023865982509481,
                "mdd": -0.016918752169665097,
                "sharpe0": -0.02389210887478188
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13447950493880612,
              "sharpe0": 0.5756194800292718,
              "mdd": -0.28033090322707666,
              "calmar": 0.47971701796242416
            },
            "post": {
              "cagr": 0.21097999283142777,
              "sharpe0": 1.077556112270354,
              "mdd": -0.35519507221988833,
              "calmar": 0.593983445527132
            },
            "delta_post_minus_pre": {
              "cagr": 0.07650048789262165,
              "sharpe0": 0.5019366322410823,
              "mdd": -0.07486416899281167,
              "calmar": 0.11426642756470784
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21097999283142777,
            "mdd": -0.35519507221988833,
            "sharpe0": 1.077556112270354
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.007023865982509481,
            "sharpe0": -0.02389210887478188
          },
          "delta_abs_mdd": 0.016918752169665097
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__always_leverage_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__always_leverage_1.1x.csv"
    },
    {
      "strategy_id": "always_leverage_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.009771413033085832,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14748387833189022,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.21484350909497218,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.034345978397936155,
        "exit_cost_total": 0.053770716619460986,
        "cost_paid_total": 0.08811669501739712,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9996149999999999,
          "end": 4.275608927149171,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.09124958088825275,
          "vol_ann": 0.356885785024378,
          "sharpe0": 0.558147358139244,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8953444261420138,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10191561841898296,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.03265792610250298,
        "delta_vs_base": {
          "cagr": 0.00487485889770678,
          "mdd": -0.12198529655998691,
          "sharpe0": 0.04697077834879648
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.009771413033085832,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.054027666232391997,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8945607127671436,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.012971410738810654,
                "exit_cost_total": 0.020137308762565632,
                "cost_paid_total": 0.033108719501376276,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 1.886879018898282,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13817300899155982,
                "vol_ann": 0.31738717321439924,
                "sharpe0": 0.5648963711706304,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.30109113038071833,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.45890760321250673,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.007433167510366712,
                "mdd": -0.04299594275786123,
                "sharpe0": -0.025469084219632787
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.021697471843182,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.20407889747723618,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9566190636012304,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.048730163803521874,
                "exit_cost_total": 0.07864395411332831,
                "cost_paid_total": 0.1273741179168502,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 10.056681138307024,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.21759479439238238,
                "vol_ann": 0.20641032181618799,
                "sharpe0": 1.0574800254527073,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3705349673710031,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5872449662072315,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.032814614343707714,
              "delta_vs_base": {
                "cagr": 0.0136386675434641,
                "mdd": -0.032258647320779876,
                "sharpe0": -0.04396819569242871
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13817300899155982,
              "sharpe0": 0.5648963711706304,
              "mdd": -0.30109113038071833,
              "calmar": 0.45890760321250673
            },
            "post": {
              "cagr": 0.21759479439238238,
              "sharpe0": 1.0574800254527073,
              "mdd": -0.3705349673710031,
              "calmar": 0.5872449662072315
            },
            "delta_post_minus_pre": {
              "cagr": 0.07942178540082256,
              "sharpe0": 0.49258365428207684,
              "mdd": -0.06944383699028478,
              "calmar": 0.1283373629947248
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21759479439238238,
            "mdd": -0.3705349673710031,
            "sharpe0": 1.0574800254527073
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.0136386675434641,
            "sharpe0": -0.04396819569242871
          },
          "delta_abs_mdd": 0.032258647320779876
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__always_leverage_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__always_leverage_1.2x.csv"
    },
    {
      "strategy_id": "always_leverage_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.014657119549628752,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.2212258174978361,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10507062635692466,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.05151896759690424,
        "exit_cost_total": 0.08065607492919152,
        "cost_paid_total": 0.13217504252609574,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9994225000000001,
          "end": 4.4283507808674,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.09356616963179643,
          "vol_ann": 0.4212233046107259,
          "sharpe0": 0.607122082682683,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9504611235133191,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09844292135372673,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.03265792610250298,
        "delta_vs_base": {
          "cagr": 0.007191447641250459,
          "mdd": -0.17710199393129222,
          "sharpe0": 0.09594550289223547
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.014657119549628752,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.081041499348589,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8854979480903311,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.019457116108215985,
                "exit_cost_total": 0.030205963143848446,
                "cost_paid_total": 0.04966307925206444,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000001,
                "end": 1.9163882336830926,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14182164549877307,
                "vol_ann": 0.34132491919319313,
                "sharpe0": 0.5572569079355498,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3205180156858144,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.44247636188348544,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.011081804017579966,
                "mdd": -0.06242282806295729,
                "sharpe0": -0.033108547454713366
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.03254620776477301,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.30611834621585693,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9526468096420737,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0730952457052828,
                "exit_cost_total": 0.11796593116999254,
                "cost_paid_total": 0.19106117687527538,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000001,
                "end": 10.677180186641122,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.22384758665256377,
                "vol_ann": 0.21685582359014077,
                "sharpe0": 1.0403722806781492,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.38450716125668105,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5821675360244654,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.032814614343707714,
              "delta_vs_base": {
                "cagr": 0.019891459803645484,
                "mdd": -0.04623084120645782,
                "sharpe0": -0.06107594046698672
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14182164549877307,
              "sharpe0": 0.5572569079355498,
              "mdd": -0.3205180156858144,
              "calmar": 0.44247636188348544
            },
            "post": {
              "cagr": 0.22384758665256377,
              "sharpe0": 1.0403722806781492,
              "mdd": -0.38450716125668105,
              "calmar": 0.5821675360244654
            },
            "delta_post_minus_pre": {
              "cagr": 0.0820259411537907,
              "sharpe0": 0.4831153727425994,
              "mdd": -0.06398914557086666,
              "calmar": 0.13969117414097992
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22384758665256377,
            "mdd": -0.38450716125668105,
            "sharpe0": 1.0403722806781492
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.019891459803645484,
            "sharpe0": -0.06107594046698672
          },
          "delta_abs_mdd": 0.04623084120645782
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__always_leverage_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__always_leverage_1.3x.csv"
    },
    {
      "strategy_id": "always_leverage_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.024428532582714584,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.3593907074058595,
        "trades": 65,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 272,
        "skipped_entries_same_day_exit": 64,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 422,
        "equity_min": -0.11447513911916962,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 64,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.08535145452689752,
        "exit_cost_total": 0.13375362780689937,
        "cost_paid_total": 0.21910508233379694,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9990375,
          "end": 4.780947496281172,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.09863718512698116,
          "vol_ann": 48.60572875134654,
          "sharpe0": -0.19614046111301298,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0507156779221392,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09387619048574855,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.030750893921334923,
        "delta_vs_base": {
          "cagr": 0.012262463136435198,
          "mdd": -0.27735654834011225,
          "sharpe0": -0.7073170409034605
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.024428532582714584,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.1350691655809815,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8673724187367069,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.03242852684702664,
                "exit_cost_total": 0.050343271906414064,
                "cost_paid_total": 0.08277179875344075,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 1.975406663252714,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14898920987229758,
                "vol_ann": 0.3887778174162987,
                "sharpe0": 0.5487101502151864,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3558545620084834,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4186800614031351,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.01824936839110447,
                "mdd": -0.09775937438562632,
                "sharpe0": -0.04165530517507676
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.5101972436930888,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9447023017237604,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.12182540950880463,
                "exit_cost_total": 0.19660988528332085,
                "cost_paid_total": 0.3184352947921256,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 11.918178283309295,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.2354181256636365,
                "vol_ann": 0.23644458536489418,
                "sharpe0": 1.0127688749151476,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4090202139427396,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5755659931677451,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.032814614343707714,
              "delta_vs_base": {
                "cagr": 0.03146199881471823,
                "mdd": -0.07074389389251634,
                "sharpe0": -0.08867934622998841
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14898920987229758,
              "sharpe0": 0.5487101502151864,
              "mdd": -0.3558545620084834,
              "calmar": 0.4186800614031351
            },
            "post": {
              "cagr": 0.2354181256636365,
              "sharpe0": 1.0127688749151476,
              "mdd": -0.4090202139427396,
              "calmar": 0.5755659931677451
            },
            "delta_post_minus_pre": {
              "cagr": 0.08642891579133893,
              "sharpe0": 0.4640587246999611,
              "mdd": -0.05316565193425615,
              "calmar": 0.15688593176461008
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2354181256636365,
            "mdd": -0.4090202139427396,
            "sharpe0": 1.0127688749151476
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.03146199881471823,
            "sharpe0": -0.08867934622998841
          },
          "delta_abs_mdd": 0.07074389389251634
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447513911916962)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447513911916962)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "equity_curve_csv": "equity_curve.e49ef1f199__always_leverage_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__always_leverage_1.5x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.004885706516542921,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.049495468004723084,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.26827897745431245,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.035646025601576314,
        "exit_cost_total": 0.05472689137559883,
        "cost_paid_total": 0.0903729169771751,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.022889271346121,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08723688201196089,
          "vol_ann": 0.31949230911169,
          "sharpe0": 0.5408691720552173,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.862625553046511,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10112948973499428,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.06626936829558999,
        "delta_vs_base": {
          "cagr": 0.0008621600214149261,
          "mdd": -0.0892664234644841,
          "sharpe0": 0.029692592264769835
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.004885706516542921,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.016334514758729,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126862421207675,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.01516609482098598,
                "exit_cost_total": 0.023118701454693497,
                "cost_paid_total": 0.03828479627567946,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7985800193578048,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1270260479809584,
                "vol_ann": 0.274896833207525,
                "sharpe0": 0.5714721688478156,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2754519738909832,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4611549744465874,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.0037137935002347078,
                "mdd": -0.01735678626812609,
                "sharpe0": -0.018893286542447596
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.010848735921591012,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.07356720009345077,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563571519544,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04547678769114149,
                "exit_cost_total": 0.07108033054431884,
                "cost_paid_total": 0.11655711823546043,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.302221136669896,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20948443475084022,
                "vol_ann": 0.1903079990168684,
                "sharpe0": 1.0950207756184789,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3465580704462178,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6044713790133768,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.06224627875507442,
              "delta_vs_base": {
                "cagr": 0.005528307901921936,
                "mdd": -0.008281750395994547,
                "sharpe0": -0.006427445526657083
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1270260479809584,
              "sharpe0": 0.5714721688478156,
              "mdd": -0.2754519738909832,
              "calmar": 0.4611549744465874
            },
            "post": {
              "cagr": 0.20948443475084022,
              "sharpe0": 1.0950207756184789,
              "mdd": -0.3465580704462178,
              "calmar": 0.6044713790133768
            },
            "delta_post_minus_pre": {
              "cagr": 0.08245838676988182,
              "sharpe0": 0.5235486067706633,
              "mdd": -0.07110609655523459,
              "calmar": 0.1433164045667894
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20948443475084022,
            "mdd": -0.3465580704462178,
            "sharpe0": 1.0950207756184789
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.005528307901921936,
            "sharpe0": -0.006427445526657083
          },
          "delta_abs_mdd": 0.008281750395994547
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.1x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.009771413033085832,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.09899093600944611,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10216868033756232,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.07129205120315252,
        "exit_cost_total": 0.1094537827511975,
        "cost_paid_total": 0.18074583395435,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.075653322979517,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08808847823483346,
          "vol_ann": 0.3903635581623627,
          "sharpe0": 0.6111350254406578,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9486373956627013,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09285790191024085,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.06626936829558999,
        "delta_vs_base": {
          "cagr": 0.0017137562442874898,
          "mdd": -0.17527826608067443,
          "sharpe0": 0.09995844565021028
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.009771413033085832,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.032669029517457954,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126862421207675,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.03033218964197192,
                "exit_cost_total": 0.046237402909386924,
                "cost_paid_total": 0.07656959255135887,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7692994493869525,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12326379496903872,
                "vol_ann": 0.28116663286879845,
                "sharpe0": 0.5529784363890683,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.29217594591626384,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.42188207719319065,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.007476046512154388,
                "mdd": -0.03408075829340673,
                "sharpe0": -0.0373870190011949
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.021697471843182,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.14713440018690152,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563571519544,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.09095357538228288,
                "exit_cost_total": 0.14216066108863754,
                "cost_paid_total": 0.23311423647092055,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.78875923170094,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.2147543111559238,
                "vol_ann": 0.1969064018937146,
                "sharpe0": 1.0869106823874428,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3544979857208014,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6057983960593274,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.06224627875507442,
              "delta_vs_base": {
                "cagr": 0.01079818430700552,
                "mdd": -0.016221665670578145,
                "sharpe0": -0.014537538757693147
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12326379496903872,
              "sharpe0": 0.5529784363890683,
              "mdd": -0.29217594591626384,
              "calmar": 0.42188207719319065
            },
            "post": {
              "cagr": 0.2147543111559238,
              "sharpe0": 1.0869106823874428,
              "mdd": -0.3544979857208014,
              "calmar": 0.6057983960593274
            },
            "delta_post_minus_pre": {
              "cagr": 0.09149051618688508,
              "sharpe0": 0.5339322459983745,
              "mdd": -0.06232203980453754,
              "calmar": 0.18391631886613674
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.2147543111559238,
            "mdd": -0.3544979857208014,
            "sharpe0": 1.0869106823874428
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.01079818430700552,
            "sharpe0": -0.014537538757693147
          },
          "delta_abs_mdd": 0.016221665670578145
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.2x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.014657119549628752,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.147636860169489,
        "trades": 138,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 44,
        "skipped_entries_same_day_exit": 17,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 124,
        "equity_min": -0.06394161677918925,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 17,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.10665035226396133,
        "exit_cost_total": 0.16372230583997396,
        "cost_paid_total": 0.2703726581039354,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.122773198584486,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08884026507584619,
          "vol_ann": 5.876645298488883,
          "sharpe0": -0.030048988218766795,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0315694598901681,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.08612145718748311,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.06579261025029798,
        "delta_vs_base": {
          "cagr": 0.002465543085300226,
          "mdd": -0.2582103303081412,
          "sharpe0": -0.5412255680092143
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.014657119549628752,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.049003544276187055,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126862421207675,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.0454982844629579,
                "exit_cost_total": 0.06935610436408043,
                "cost_paid_total": 0.11485438882703834,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.740018879416099,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11945163221874999,
                "vol_ann": 0.2877394083889257,
                "sharpe0": 0.5349660970784164,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3083010919421193,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.3874512135726588,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.011288209262443116,
                "mdd": -0.050205904319262196,
                "sharpe0": -0.055399358311846836
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.03254620776477301,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.2207016002803523,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563571519544,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.13643036307342438,
                "exit_cost_total": 0.21324099163295632,
                "cost_paid_total": 0.3496713547063808,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 10.275297326731986,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.21978981975294332,
                "vol_ann": 0.20369492234251413,
                "sharpe0": 1.0776899077887663,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.36211680215229947,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.606958358315845,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.06224627875507442,
              "delta_vs_base": {
                "cagr": 0.015833692904025032,
                "mdd": -0.023840482102076233,
                "sharpe0": -0.023758313356369687
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11945163221874999,
              "sharpe0": 0.5349660970784164,
              "mdd": -0.3083010919421193,
              "calmar": 0.3874512135726588
            },
            "post": {
              "cagr": 0.21978981975294332,
              "sharpe0": 1.0776899077887663,
              "mdd": -0.36211680215229947,
              "calmar": 0.606958358315845
            },
            "delta_post_minus_pre": {
              "cagr": 0.10033818753419332,
              "sharpe0": 0.5427238107103499,
              "mdd": -0.05381571021018017,
              "calmar": 0.21950714474318617
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21978981975294332,
            "mdd": -0.36211680215229947,
            "sharpe0": 1.0776899077887663
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.015833692904025032,
            "sharpe0": -0.023758313356369687
          },
          "delta_abs_mdd": 0.023840482102076233
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394161677918925)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394161677918925)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "equity_curve_csv": "equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.3x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-26T06:35:11Z",
      "schema_version": "v27.0",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0
      },
      "audit": {
        "rows": 4195,
        "start_date": "2009-01-02",
        "end_date": "2026-02-25",
        "base_price_t0": 20.46786880493164,
        "base_shares": 0.04885706516542917,
        "lever_shares_target": 0.024428532582714584,
        "bb_z_non_nan": 4136,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.20737755850950568,
        "trades": 94,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 912,
        "skipped_entries_same_day_exit": 12,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 1422,
        "equity_min": -0.3961622110126891,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 12,
        "exit_count_by_trend_off": 81,
        "exit_count_by_end_of_data": 1,
        "exit_count_by_take_profit": 0,
        "exit_count_by_stop_loss": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.1488739441115685,
        "exit_cost_total": 0.22872645377732095,
        "cost_paid_total": 0.3776003978888895,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
        "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb."
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.245111653591588,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.09075507696666207,
          "vol_ann": 8.830676563850464,
          "sharpe0": -0.19442935470357248,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.1888330361407813,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9701252197127253,
          "n_days": 4195,
          "years": 16.642857142857142,
          "cagr": 0.08637472199054597,
          "vol_ann": 0.2812583145055213,
          "sharpe0": 0.5111765797904475,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7733591295820269,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.07633963240227022,
        "calmar_base_only": 0.11168772525802913,
        "turnover_proxy": 0.044815256257449344,
        "delta_vs_base": {
          "cagr": 0.004380354976116108,
          "mdd": -0.4154739065587544,
          "sharpe0": -0.70560593449402
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.46786880493164
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.46786880493164,
                "base_shares": 0.04885706516542917,
                "lever_shares_target": 0.024428532582714584,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08167257379364568,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126862421207675,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07583047410492981,
                "exit_cost_total": 0.11559350727346736,
                "cost_paid_total": 0.19142398137839725,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.681457739474395,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11167142855998802,
                "vol_ann": 0.3016821718634464,
                "sharpe0": 0.5006012842194172,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33887910968726864,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.827860589328657,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307398414811931,
                "vol_ann": 0.26896249062066235,
                "sharpe0": 0.5903654553902632,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2580951876228571,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.32953175739585405,
              "calmar_base_only": 0.5065566804455004,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.01906841292120509,
                "mdd": -0.08078392206441154,
                "sharpe0": -0.08976417117084601
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2956,
              "rows_clean": 2956,
              "start_date": "2014-01-03",
              "end_date": "2026-02-25",
              "first_price": 9.217663764953612
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T06:35:11Z",
              "schema_version": "v27.0",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-26.v27.0.bb_tactical_tp_sl_exit",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "exit_mode": "z",
                "take_profit_pct": 0.0,
                "stop_loss_pct": 0.0
              },
              "audit": {
                "rows": 2956,
                "start_date": "2014-01-03",
                "end_date": "2026-02-25",
                "base_price_t0": 9.217663764953612,
                "base_shares": 0.10848735921591002,
                "lever_shares_target": 0.05424367960795501,
                "bb_z_non_nan": 2897,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.367836000467257,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.964563571519544,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "exit_count_by_take_profit": 0,
                "exit_count_by_stop_loss": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.2273839384557073,
                "exit_cost_total": 0.35540165272159385,
                "cost_paid_total": 0.5827855911773012,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "exit_mode_semantics": "exit_mode='z' uses bb_z >= exit_z for bb entry_mode; exit_mode='tp_sl' uses take_profit_pct/stop_loss_pct on price/entry_price (EOD) and ignores exit_z for bb.",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 11.24837351679408,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.22923828614001907,
                "vol_ann": 0.21767274962077476,
                "sharpe0": 1.057506267024038,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.37646602357803516,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.81568304163885,
                "n_days": 2956,
                "years": 11.726190476190476,
                "cagr": 0.20395612684891828,
                "vol_ann": 0.1839565216243862,
                "sharpe0": 1.101448221145136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33827632005022323,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6089215806549453,
              "calmar_base_only": 0.6029275913213119,
              "turnover_proxy": 0.06224627875507442,
              "delta_vs_base": {
                "cagr": 0.02528215929110078,
                "mdd": -0.038189703527811925,
                "sharpe0": -0.043941954121097915
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11167142855998802,
              "sharpe0": 0.5006012842194172,
              "mdd": -0.33887910968726864,
              "calmar": 0.32953175739585405
            },
            "post": {
              "cagr": 0.22923828614001907,
              "sharpe0": 1.057506267024038,
              "mdd": -0.37646602357803516,
              "calmar": 0.6089215806549453
            },
            "delta_post_minus_pre": {
              "cagr": 0.11756685758003105,
              "sharpe0": 0.5569049828046209,
              "mdd": -0.037586913890766516,
              "calmar": 0.27938982325909123
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22923828614001907,
            "mdd": -0.37646602357803516,
            "sharpe0": 1.057506267024038
          },
          "post_base_only": {
            "cagr": 0.20395612684891828,
            "mdd": -0.33827632005022323,
            "sharpe0": 1.101448221145136
          },
          "delta_vs_base": {
            "cagr": 0.02528215929110078,
            "sharpe0": -0.043941954121097915
          },
          "delta_abs_mdd": 0.038189703527811925
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961622110126891)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.3961622110126891)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "equity_curve_csv": "equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.e49ef1f199__trend_leverage_price_gt_ma60_1.5x.csv"
    }
  ],
  "compare": {
    "rows": [
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
        "entry_mode": "trend",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.08808847823483346,
        "full_mdd": -0.9486373956627013,
        "full_sharpe0": 0.6111350254406578,
        "full_calmar": 0.09285790191024085,
        "full_turnover_proxy": 0.06626936829558999,
        "full_delta_cagr_vs_base": 0.0017137562442874898,
        "full_delta_mdd_vs_base": -0.17527826608067443,
        "full_delta_sharpe0_vs_base": 0.09995844565021028,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.2147543111559238,
        "post_mdd": -0.3544979857208014,
        "post_sharpe0": 1.0869106823874428,
        "post_calmar": 0.6057983960593274,
        "post_delta_cagr_vs_base": 0.01079818430700552,
        "post_delta_sharpe0_vs_base": -0.014537538757693147,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
        "entry_mode": "trend",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.08723688201196089,
        "full_mdd": -0.862625553046511,
        "full_sharpe0": 0.5408691720552173,
        "full_calmar": 0.10112948973499428,
        "full_turnover_proxy": 0.06626936829558999,
        "full_delta_cagr_vs_base": 0.0008621600214149261,
        "full_delta_mdd_vs_base": -0.0892664234644841,
        "full_delta_sharpe0_vs_base": 0.029692592264769835,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.20948443475084022,
        "post_mdd": -0.3465580704462178,
        "post_sharpe0": 1.0950207756184789,
        "post_calmar": 0.6044713790133768,
        "post_delta_cagr_vs_base": 0.005528307901921936,
        "post_delta_sharpe0_vs_base": -0.006427445526657083,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.1x",
        "entry_mode": "always",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.08885435014957133,
        "full_mdd": -0.8364448578675947,
        "full_sharpe0": 0.5286785358334825,
        "full_calmar": 0.10622858077709237,
        "full_turnover_proxy": 0.03265792610250298,
        "full_delta_cagr_vs_base": 0.00247962815902536,
        "full_delta_mdd_vs_base": -0.0630857282855678,
        "full_delta_sharpe0_vs_base": 0.01750195604303495,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.21097999283142777,
        "post_mdd": -0.35519507221988833,
        "post_sharpe0": 1.077556112270354,
        "post_calmar": 0.593983445527132,
        "post_delta_cagr_vs_base": 0.007023865982509481,
        "post_delta_sharpe0_vs_base": -0.02389210887478188,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.2x",
        "entry_mode": "always",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.09124958088825275,
        "full_mdd": -0.8953444261420138,
        "full_sharpe0": 0.558147358139244,
        "full_calmar": 0.10191561841898296,
        "full_turnover_proxy": 0.03265792610250298,
        "full_delta_cagr_vs_base": 0.00487485889770678,
        "full_delta_mdd_vs_base": -0.12198529655998691,
        "full_delta_sharpe0_vs_base": 0.04697077834879648,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.21759479439238238,
        "post_mdd": -0.3705349673710031,
        "post_sharpe0": 1.0574800254527073,
        "post_calmar": 0.5872449662072315,
        "post_delta_cagr_vs_base": 0.0136386675434641,
        "post_delta_sharpe0_vs_base": -0.04396819569242871,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.3x",
        "entry_mode": "always",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.09356616963179643,
        "full_mdd": -0.9504611235133191,
        "full_sharpe0": 0.607122082682683,
        "full_calmar": 0.09844292135372673,
        "full_turnover_proxy": 0.03265792610250298,
        "full_delta_cagr_vs_base": 0.007191447641250459,
        "full_delta_mdd_vs_base": -0.17710199393129222,
        "full_delta_sharpe0_vs_base": 0.09594550289223547,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.22384758665256377,
        "post_mdd": -0.38450716125668105,
        "post_sharpe0": 1.0403722806781492,
        "post_calmar": 0.5821675360244654,
        "post_delta_cagr_vs_base": 0.019891459803645484,
        "post_delta_sharpe0_vs_base": -0.06107594046698672,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "bb_conditional",
        "entry_mode": "bb",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.0880318427562059,
        "full_mdd": -0.7142125780438311,
        "full_sharpe0": 0.4997159275513603,
        "full_calmar": 0.12325720025446459,
        "full_turnover_proxy": 0.010488676996424315,
        "full_delta_cagr_vs_base": 0.0016571207656599363,
        "full_delta_mdd_vs_base": 0.05914655153819581,
        "full_delta_sharpe0_vs_base": -0.01146065223908721,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.20334070506306867,
        "post_mdd": -0.4136534658472093,
        "post_sharpe0": 0.9933807363072803,
        "post_calmar": 0.49157258877694593,
        "post_delta_cagr_vs_base": -0.0006154217858496125,
        "post_delta_sharpe0_vs_base": -0.10806748483785567,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.5x",
        "entry_mode": "always",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.09863718512698116,
        "full_mdd": -1.0507156779221392,
        "full_sharpe0": -0.19614046111301298,
        "full_calmar": 0.09387619048574855,
        "full_turnover_proxy": 0.030750893921334923,
        "full_delta_cagr_vs_base": 0.012262463136435198,
        "full_delta_mdd_vs_base": -0.27735654834011225,
        "full_delta_sharpe0_vs_base": -0.7073170409034605,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.2354181256636365,
        "post_mdd": -0.4090202139427396,
        "post_sharpe0": 1.0127688749151476,
        "post_calmar": 0.5755659931677451,
        "post_delta_cagr_vs_base": 0.03146199881471823,
        "post_delta_sharpe0_vs_base": -0.08867934622998841,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.11447513911916962); full: equity_negative_days>0 (neg_days=422)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
        "entry_mode": "trend",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.08884026507584619,
        "full_mdd": -1.0315694598901681,
        "full_sharpe0": -0.030048988218766795,
        "full_calmar": 0.08612145718748311,
        "full_turnover_proxy": 0.06579261025029798,
        "full_delta_cagr_vs_base": 0.002465543085300226,
        "full_delta_mdd_vs_base": -0.2582103303081412,
        "full_delta_sharpe0_vs_base": -0.5412255680092143,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.21978981975294332,
        "post_mdd": -0.36211680215229947,
        "post_sharpe0": 1.0776899077887663,
        "post_calmar": 0.606958358315845,
        "post_delta_cagr_vs_base": 0.015833692904025032,
        "post_delta_sharpe0_vs_base": -0.023758313356369687,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.06394161677918925); full: equity_negative_days>0 (neg_days=124)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
        "entry_mode": "trend",
        "exit_mode": "z",
        "take_profit_pct": 0.0,
        "stop_loss_pct": 0.0,
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.46786880493164,
        "full_cagr": 0.09075507696666207,
        "full_mdd": -1.1888330361407813,
        "full_sharpe0": -0.19442935470357248,
        "full_calmar": 0.07633963240227022,
        "full_turnover_proxy": 0.044815256257449344,
        "full_delta_cagr_vs_base": 0.004380354976116108,
        "full_delta_mdd_vs_base": -0.4154739065587544,
        "full_delta_sharpe0_vs_base": -0.70560593449402,
        "post_ok": true,
        "post_segment_start_price": 9.217663764953612,
        "post_cagr": 0.22923828614001907,
        "post_mdd": -0.37646602357803516,
        "post_sharpe0": 1.057506267024038,
        "post_calmar": 0.6089215806549453,
        "post_delta_cagr_vs_base": 0.02528215929110078,
        "post_delta_sharpe0_vs_base": -0.043941954121097915,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.3961622110126891); full: equity_negative_days>0 (neg_days=1422)",
        "ok": true
      }
    ],
    "ranking_policy": "prefer post (calmar desc, sharpe0 desc) when post_ok=true; else fallback to full; EXCLUDE hard_fail",
    "top3_by_policy": [
      "trend_leverage_price_gt_ma60_1.2x",
      "trend_leverage_price_gt_ma60_1.1x",
      "always_leverage_1.1x"
    ]
  },
  "failed_strategies": [],
  "suite_ok": true,
  "abort_reason": null,
  "outputs": {
    "export_strategy_id": "trend_leverage_price_gt_ma60_1.2x",
    "export_policy": "top1_by_compare_policy else first_success"
  },
  "notes": [
    "Hard-fail strategies are excluded from ranking.",
    "Maintenance margin forced close approximates margin call at EOD on trigger bar; intraday is not modeled.",
    "Maintenance ratio thresholds are NOT interchangeable across maint_ratio_mode values.",
    "JSON output is sanitized: NaN/Inf are converted to null; allow_nan=False enforced.",
    "v26.5+: RV20 entry filter is enabled for BB mode (defensive).",
    "v26.6: hard_fail scope='post' still enforces full_floor.",
    "v26.7+: write per-strategy equity curve CSV for renderer evidence.",
    "v26.8: default post_start_date excludes split_date (cut singularity day from segment stats).",
    "v26.9: cleanup old equity_curve.*.csv files in cache_dir at start of run.",
    "v27.0: optional BB tactical tp/sl exit strategy (enabled only by --add_bb_tactical)."
  ]
}