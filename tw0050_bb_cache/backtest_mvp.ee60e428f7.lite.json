{
  "generated_at_utc": "2026-02-26T08:29:14Z",
  "schema_version": "v26.9",
  "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
  "inputs": {
    "cache_dir": "tw0050_bb_cache",
    "price_csv": "data.csv",
    "price_csv_resolved": "tw0050_bb_cache/data.csv",
    "stats_json": "stats_latest.json",
    "stats_json_resolved": "tw0050_bb_cache/stats_latest.json",
    "price_col": "adjclose",
    "break_ratio_hi": 1.8,
    "break_ratio_lo": 0.5555555556,
    "break_ratio_policy": "ratio_lo defaults to 1/ratio_hi (symmetric inverse) unless overridden",
    "breaks_detected": 1,
    "break_samples_first5": [
      {
        "idx": 1238,
        "break_date": "2014-01-02",
        "prev_date": "2013-12-31",
        "prev_price": 37.412410736083984,
        "price": 9.329200744628906,
        "ratio": 0.2493611227151145
      }
    ],
    "break_samples_source": "detect_breaks_from_price",
    "forbid_mask_built": true,
    "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
    "gonogo_thresholds": {
      "delta_sharpe0_lt": 0.0,
      "delta_abs_mdd_gt": 0.0,
      "delta_cagr_lt": 0.01,
      "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
    },
    "maintenance_margin": 0.0,
    "maint_ratio_mode": "equity_over_lever_notional",
    "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
    "hard_fail_policy": {
      "scope": "any",
      "equity_le": 0.0,
      "any_negative_days": true
    },
    "segment_min_rows_mult": 3.0,
    "segment_post_start_default_policy": "exclude_split_day_next_row (v26.8) unless --segment_post_start_date is provided",
    "rv20_filter_policy": {
      "enabled": true,
      "scope": "bb_entry_only",
      "rv20_window": 20,
      "q_lookback": 252,
      "q": 0.6,
      "q_min_periods": 100
    },
    "equity_curve_tag": "0d3098298f",
    "equity_curve_cleanup": {
      "ok": true,
      "cache_dir": "tw0050_bb_cache",
      "removed": 37,
      "errors": []
    }
  },
  "strategy_suite": {
    "mode": "all",
    "bench_levels": [
      1.1,
      1.2,
      1.3,
      1.5
    ],
    "trend_rule": "price_gt_ma60",
    "trend_ma_fast": 20,
    "trend_ma_slow": 60,
    "omit_trades": false,
    "fail_fast": true
  },
  "strategies": [
    {
      "strategy_id": "bb_conditional",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:14Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "bb",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.02442853941201494,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.04559445395539196,
        "trades": 22,
        "skipped_entries_on_forbidden": 18,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 1,
        "skipped_entries_on_rv20": 147,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.5601189448157451,
        "open_at_end": false,
        "forced_eod_close": 0,
        "exit_count_by_exit_z": 21,
        "exit_count_by_max_hold_days": 1,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 0,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.026944939927271826,
        "exit_cost_total": 0.04157443707596782,
        "cost_paid_total": 0.06851937700323965,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.066749560385463,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0879236435079922,
          "vol_ann": 0.2771405829153112,
          "sharpe0": 0.4993774934310797,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.7142132404752984,
          "mdd_peak": "2011-06-01",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.12310559161502005,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.010486177311725452,
        "delta_vs_base": {
          "cagr": 0.0016587540145365232,
          "mdd": 0.0591458207193406,
          "sharpe0": -0.011456618457905632
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.02442853941201494,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.018204505081539268,
                "trades": 7,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 0,
                "skipped_entries_on_rv20": 50,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864972735671,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 7,
                "exit_count_by_max_hold_days": 0,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.010895842573260503,
                "exit_cost_total": 0.017058794819102125,
                "cost_paid_total": 0.027954637392362636,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.953590602541849,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1461678616493025,
                "vol_ann": 0.2766763446801984,
                "sharpe0": 0.6305289504143236,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.26581942779582124,
                "mdd_peak": "2011-06-01",
                "mdd_trough": "2012-06-04",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5498765190389907,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.011308562197092083,
              "delta_vs_base": {
                "cagr": 0.015427955770118018,
                "mdd": -0.0077243358389915695,
                "sharpe0": 0.04016295133992398
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "bb",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.054243673995817254,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.060819496099083624,
                "trades": 15,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 1,
                "skipped_entries_on_rv20": 97,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645635751858532,
                "open_at_end": false,
                "forced_eod_close": 0,
                "exit_count_by_exit_z": 14,
                "exit_count_by_max_hold_days": 1,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 0,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.035637087838741026,
                "exit_cost_total": 0.05443708622732666,
                "cost_paid_total": 0.09007417406606767,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 8.751051532020536,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20312556257399805,
                "vol_ann": 0.20814425081836416,
                "sharpe0": 0.9927222607200273,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.4136536180783389,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.49105230486713536,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.010145417653026716,
              "delta_vs_base": {
                "cagr": -0.0006159406717893834,
                "mdd": -0.0753771453545774,
                "sharpe0": -0.10801207087624365
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1461678616493025,
              "sharpe0": 0.6305289504143236,
              "mdd": -0.26581942779582124,
              "calmar": 0.5498765190389907
            },
            "post": {
              "cagr": 0.20312556257399805,
              "sharpe0": 0.9927222607200273,
              "mdd": -0.4136536180783389,
              "calmar": 0.49105230486713536
            },
            "delta_post_minus_pre": {
              "cagr": 0.05695770092469554,
              "sharpe0": 0.3621933103057038,
              "mdd": -0.14783419028251765,
              "calmar": -0.05882421417185535
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20312556257399805,
            "mdd": -0.4136536180783389,
            "sharpe0": 0.9927222607200273
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": -0.0006159406717893834,
            "sharpe0": -0.10801207087624365
          },
          "delta_abs_mdd": 0.0753771453545774
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": true,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__bb_conditional.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__bb_conditional.csv"
    },
    {
      "strategy_id": "always_leverage_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:14Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.004885707882402992,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.0737848167408612,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.324616804459114,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.01717299386535156,
        "exit_cost_total": 0.02688379434489435,
        "cost_paid_total": 0.0440567882102459,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9998075,
          "end": 4.116915443633585,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08873777046223053,
          "vol_ann": 0.3150935856213466,
          "sharpe0": 0.528345570979159,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.836444667330783,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10608922972203971,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.0024728809687748488,
          "mdd": -0.063085606136144,
          "sharpe0": 0.01751145909017371
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.004885707882402992,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.02701383971307805,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.903623758112035,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.006485707039056277,
                "exit_cost_total": 0.010068657768504595,
                "cost_paid_total": 0.016554364807560878,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 1.8573705941342928,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13447960324198904,
                "vol_ann": 0.29327472645532526,
                "sharpe0": 0.5756200817387044,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.28033074055823126,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.479717646998669,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.0037396973628045505,
                "mdd": -0.022235648601401592,
                "sharpe0": -0.014745917335695191
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.01084873479916346,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.10214359467296018,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9605913215933273,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.024365079858903228,
                "exit_cost_total": 0.03931848272144768,
                "cost_paid_total": 0.0636835625803509,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9998075,
                "end": 9.422953270543838,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21075675928856707,
                "vol_ann": 0.19541404994768274,
                "sharpe0": 1.0768390375956822,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3551952301451109,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5933547001812632,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.0070152560427796384,
                "mdd": -0.016918757421349406,
                "sharpe0": -0.023895294000588763
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13447960324198904,
              "sharpe0": 0.5756200817387044,
              "mdd": -0.28033074055823126,
              "calmar": 0.479717646998669
            },
            "post": {
              "cagr": 0.21075675928856707,
              "sharpe0": 1.0768390375956822,
              "mdd": -0.3551952301451109,
              "calmar": 0.5933547001812632
            },
            "delta_post_minus_pre": {
              "cagr": 0.07627715604657803,
              "sharpe0": 0.5012189558569778,
              "mdd": -0.07486448958687963,
              "calmar": 0.11363705318259426
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21075675928856707,
            "mdd": -0.3551952301451109,
            "sharpe0": 1.0768390375956822
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.0070152560427796384,
            "sharpe0": -0.023895294000588763
          },
          "delta_abs_mdd": 0.016918757421349406
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.1x.csv"
    },
    {
      "strategy_id": "always_leverage_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:14Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.009771415764805974,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14756963348172233,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.21484416631449532,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03434598773070309,
        "exit_cost_total": 0.053767588689788655,
        "cost_paid_total": 0.0881135764204917,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9996149999999999,
          "end": 4.269078866147159,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.09112667779667927,
          "vol_ann": 0.3568362397068225,
          "sharpe0": 0.5578271601642126,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8953441191618263,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.101778384250725,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.004861788303223591,
          "mdd": -0.12198505796718728,
          "sharpe0": 0.04699304827522732
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.009771415764805974,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.054027679426156064,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8945610189505029,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.012971414078112545,
                "exit_cost_total": 0.02013731553700917,
                "cost_paid_total": 0.03310872961512171,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999999,
                "end": 1.8868800879387486,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.13817314035941686,
                "vol_ann": 0.31738682375100297,
                "sharpe0": 0.5648970176035204,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3010909043094342,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.45890838408527584,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.007433234480232365,
                "mdd": -0.04299581235260452,
                "sharpe0": -0.02546898147087917
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.021697469598326895,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.20428718934592036,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9566190680008015,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04873015971780642,
                "exit_cost_total": 0.07863696544289529,
                "cost_paid_total": 0.1273671251607017,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9996149999999997,
                "end": 10.042158086027976,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21736371277611255,
                "vol_ann": 0.20636075016079744,
                "sharpe0": 1.0567642180006074,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3705351312766605,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5866210635067088,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.013622209530325113,
                "mdd": -0.032258658552899,
                "sharpe0": -0.04397011359566361
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.13817314035941686,
              "sharpe0": 0.5648970176035204,
              "mdd": -0.3010909043094342,
              "calmar": 0.45890838408527584
            },
            "post": {
              "cagr": 0.21736371277611255,
              "sharpe0": 1.0567642180006074,
              "mdd": -0.3705351312766605,
              "calmar": 0.5866210635067088
            },
            "delta_post_minus_pre": {
              "cagr": 0.07919057241669569,
              "sharpe0": 0.491867200397087,
              "mdd": -0.0694442269672263,
              "calmar": 0.127712679421433
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21736371277611255,
            "mdd": -0.3705351312766605,
            "sharpe0": 1.0567642180006074
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.013622209530325113,
            "sharpe0": -0.04397011359566361
          },
          "delta_abs_mdd": 0.032258658552899
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.2x.csv"
    },
    {
      "strategy_id": "always_leverage_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:14Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.014657123647208965,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.2213544502225871,
        "trades": 69,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 68,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10507152816987808,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 68,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.05151898159605463,
        "exit_cost_total": 0.08065138303468299,
        "cost_paid_total": 0.1321703646307376,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9994225000000003,
          "end": 4.421242288660731,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.09343732531087023,
          "vol_ann": 0.4211671835573221,
          "sharpe0": 0.6068223682663821,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.950460705469819,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09830740479132544,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.032650142993326976,
        "delta_vs_base": {
          "cagr": 0.0071724358174145575,
          "mdd": -0.17710164427517994,
          "sharpe0": 0.09598825637739683
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.014657123647208965,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08104151913923328,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8854982797889708,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.019457121117168814,
                "exit_cost_total": 0.030205973305513764,
                "cost_paid_total": 0.04966309442268258,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994225000000003,
                "end": 1.9163895817432062,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.14182180912569264,
                "vol_ann": 0.34132452734847857,
                "sharpe0": 0.5572575883117906,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.32051772954447344,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4424772674112374,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.011081903246508151,
                "mdd": -0.06242263758764377,
                "sharpe0": -0.03310841076260895
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:14Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.032546204397490355,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.3064307840188805,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9526468144082756,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07309523957670963,
                "exit_cost_total": 0.11795544816434297,
                "cost_paid_total": 0.19105068774105266,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9994224999999999,
                "end": 10.661362901512133,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.22360930244462063,
                "vol_ann": 0.21680662262823946,
                "sharpe0": 1.03966050510904,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.38450733161831985,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5815475650450946,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.01986779919883319,
                "mdd": -0.04623085889455836,
                "sharpe0": -0.06107382648723103
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.14182180912569264,
              "sharpe0": 0.5572575883117906,
              "mdd": -0.32051772954447344,
              "calmar": 0.4424772674112374
            },
            "post": {
              "cagr": 0.22360930244462063,
              "sharpe0": 1.03966050510904,
              "mdd": -0.38450733161831985,
              "calmar": 0.5815475650450946
            },
            "delta_post_minus_pre": {
              "cagr": 0.08178749331892798,
              "sharpe0": 0.48240291679724934,
              "mdd": -0.06398960207384641,
              "calmar": 0.13907029763385725
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22360930244462063,
            "mdd": -0.38450733161831985,
            "sharpe0": 1.03966050510904
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.01986779919883319,
            "sharpe0": -0.06107382648723103
          },
          "delta_abs_mdd": 0.04623085889455836
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.3x.csv"
    },
    {
      "strategy_id": "always_leverage_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:14Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "always",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.02442853941201494,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.3596311866328358,
        "trades": 65,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 272,
        "skipped_entries_same_day_exit": 64,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 422,
        "equity_min": -0.11447374811936006,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 64,
        "exit_count_by_trend_off": 0,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.08535147726679716,
        "exit_cost_total": 0.13374580643166023,
        "cost_paid_total": 0.21909728369845738,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 0.9990375000000002,
          "end": 4.772655829721225,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.0984979990564947,
          "vol_ann": 49.262554214936316,
          "sharpe0": -0.19689933937204032,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0507150526581386,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09374377839863506,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.030743565300285988,
        "delta_vs_base": {
          "cagr": 0.012233109563039024,
          "mdd": -0.27735599146349954,
          "sharpe0": -0.7077334512610256
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.02442853941201494,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.13506919856538968,
                "trades": 21,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 20,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.8673728014659061,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 20,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.032428535195281355,
                "exit_cost_total": 0.050343288842522926,
                "cost_paid_total": 0.08277182403780428,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375000000002,
                "end": 1.9754085693521173,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1489894357303898,
                "vol_ann": 0.38877733380317564,
                "sharpe0": 0.5487108733888576,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3558541647691974,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4186811634676877,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.033117932148626815,
              "delta_vs_base": {
                "cagr": 0.018249529851205315,
                "mdd": -0.09775907281236773,
                "sharpe0": -0.04165512568554197
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "always",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.054243673995817254,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.5107179733648004,
                "trades": 49,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 48,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9447023072232243,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 48,
                "exit_count_by_trend_off": 0,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.12182539929451602,
                "exit_cost_total": 0.19659241360723828,
                "cost_paid_total": 0.31841781290175436,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 0.9990375,
                "end": 11.899772532480409,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.23516702000443623,
                "vol_ann": 0.23639548140043623,
                "sharpe0": 1.0120696247359402,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.40902039795450595,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.5749518145806339,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.032803517078119716,
              "delta_vs_base": {
                "cagr": 0.0314255167586488,
                "mdd": -0.07074392523074446,
                "sharpe0": -0.08866470686033079
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.1489894357303898,
              "sharpe0": 0.5487108733888576,
              "mdd": -0.3558541647691974,
              "calmar": 0.4186811634676877
            },
            "post": {
              "cagr": 0.23516702000443623,
              "sharpe0": 1.0120696247359402,
              "mdd": -0.40902039795450595,
              "calmar": 0.5749518145806339
            },
            "delta_post_minus_pre": {
              "cagr": 0.08617758427404643,
              "sharpe0": 0.4633587513470826,
              "mdd": -0.05316623318530855,
              "calmar": 0.15627065111294625
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.23516702000443623,
            "mdd": -0.40902039795450595,
            "sharpe0": 1.0120696247359402
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.0314255167586488,
            "sharpe0": -0.08866470686033079
          },
          "delta_abs_mdd": 0.07074392523074446
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447374811936006)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.11447374811936006)",
        "full: equity_negative_days>0 (neg_days=422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__always_leverage_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__always_leverage_1.5x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:15Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.10000000000000009,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.004885707882402992,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.04954498367704766,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.2682791520109158,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.03564603538748059,
        "exit_cost_total": 0.054725333981258145,
        "cost_paid_total": 0.09037136936873882,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.016930578593275,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08711839962044676,
          "vol_ann": 0.3194457834921298,
          "sharpe0": 0.5405317728028437,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.8626254613147566,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.10099214957980335,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.06625357483317446,
        "delta_vs_base": {
          "cagr": 0.0008535101269910861,
          "mdd": -0.08926640012011755,
          "sharpe0": 0.029697660913858392
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.004885707882402992,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.016334519002972718,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864972735671,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.015166098450944491,
                "exit_cost_total": 0.02311870715460877,
                "cost_paid_total": 0.03828480560555326,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.798580579781117,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12702611952132625,
                "vol_ann": 0.2748965617876732,
                "sharpe0": 0.5714726988289122,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.27545182609406293,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.46115548160478925,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.0037137863578582397,
                "mdd": -0.017356734137233265,
                "sharpe0": -0.01889330024548741
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.10000000000000009,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.01084873479916346,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.0736771123191062,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645635751858532,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04547678396194191,
                "exit_cost_total": 0.07107683268123219,
                "cost_paid_total": 0.11655361664317412,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.288986226076,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20925983060259146,
                "vol_ann": 0.19025761586918646,
                "sharpe0": 1.0942837920093136,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.34655826556382774,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6038229394475395,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.00551832735680402,
                "mdd": -0.008281792840066249,
                "sharpe0": -0.0064505395869574045
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12702611952132625,
              "sharpe0": 0.5714726988289122,
              "mdd": -0.27545182609406293,
              "calmar": 0.46115548160478925
            },
            "post": {
              "cagr": 0.20925983060259146,
              "sharpe0": 1.0942837920093136,
              "mdd": -0.34655826556382774,
              "calmar": 0.6038229394475395
            },
            "delta_post_minus_pre": {
              "cagr": 0.0822337110812652,
              "sharpe0": 0.5228110931804014,
              "mdd": -0.0711064394697648,
              "calmar": 0.14266745784275026
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "NO_GO",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.20925983060259146,
            "mdd": -0.34655826556382774,
            "sharpe0": 1.0942837920093136
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.00551832735680402,
            "sharpe0": -0.0064505395869574045
          },
          "delta_abs_mdd": 0.008281792840066249
        },
        "reasons": [
          "all 3 post conditions met => stop / do not deploy"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": true
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.1x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:15Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.19999999999999996,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.009771415764805974,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.09908996735409523,
        "trades": 139,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 0,
        "skipped_entries_same_day_exit": 18,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 0,
        "equity_min": 0.10216886141809972,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 18,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.07129207077496111,
        "exit_cost_total": 0.10945066796251621,
        "cost_paid_total": 0.18074273873747748,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.069109136066539,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08796155187524146,
          "vol_ann": 0.39031015636743366,
          "sharpe0": 0.6108185484213317,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.9486372986943259,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.09272411278399967,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.06625357483317446,
        "delta_vs_base": {
          "cagr": 0.001696662381785785,
          "mdd": -0.17527823749968685,
          "sharpe0": 0.09998443653234634
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.009771415764805974,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.03266903800594534,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864972735671,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.030332196901888955,
                "exit_cost_total": 0.04623741430921749,
                "cost_paid_total": 0.07656961121110643,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.7693000592323975,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.12326387384251536,
                "vol_ann": 0.2811663624403944,
                "sharpe0": 0.5529789535195064,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.2921757512444363,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.4218826282383439,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.0074760320366691335,
                "mdd": -0.03408065928760662,
                "sharpe0": -0.03738704555489314
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.19999999999999996,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.021697469598326895,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.147354224638212,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645635751858532,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.09095356792388372,
                "exit_cost_total": 0.14215366536246424,
                "cost_paid_total": 0.23310723328634803,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 9.774223997092305,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21452050072217044,
                "vol_ann": 0.19685680310236406,
                "sharpe0": 1.0861566143838597,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3544982219643733,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6051384391533832,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.010778997476383001,
                "mdd": -0.016221749240611816,
                "sharpe0": -0.0145777172124113
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.12326387384251536,
              "sharpe0": 0.5529789535195064,
              "mdd": -0.2921757512444363,
              "calmar": 0.4218826282383439
            },
            "post": {
              "cagr": 0.21452050072217044,
              "sharpe0": 1.0861566143838597,
              "mdd": -0.3544982219643733,
              "calmar": 0.6051384391533832
            },
            "delta_post_minus_pre": {
              "cagr": 0.09125662687965508,
              "sharpe0": 0.5331776608643533,
              "mdd": -0.06232247071993702,
              "calmar": 0.18325581091503929
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21452050072217044,
            "mdd": -0.3544982219643733,
            "sharpe0": 1.0861566143838597
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.010778997476383001,
            "sharpe0": -0.0145777172124113
          },
          "delta_abs_mdd": 0.016221749240611816
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": false,
      "hard_fail_reasons": [],
      "suite_hard_fail": false,
      "suite_hard_fail_reasons": [],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.2x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:15Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.30000000000000004,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.014657123647208965,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.14778540672763843,
        "trades": 138,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 44,
        "skipped_entries_same_day_exit": 17,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 124,
        "equity_min": -0.06394142917471746,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 17,
        "exit_count_by_trend_off": 120,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.1066503814874213,
        "exit_cost_total": 0.1637176335288096,
        "cost_paid_total": 0.270368015016231,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.115643544164895,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08870497106894293,
          "vol_ann": 5.87103229584399,
          "sharpe0": -0.03005977951874861,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.0315693739101066,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.08599031079481513,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.0657769304099142,
        "delta_vs_base": {
          "cagr": 0.002440081575487252,
          "mdd": -0.25821031271546757,
          "sharpe0": -0.5408938914077339
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.014657123647208965,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.049003557008917877,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864972735671,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.04549829535283344,
                "exit_cost_total": 0.06935612146382625,
                "cost_paid_total": 0.11485441681665967,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.740019538683677,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11945171862474324,
                "vol_ann": 0.2877391390567579,
                "sharpe0": 0.534966602402027,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3083008551920855,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.38745179136891905,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.011288187254441251,
                "mdd": -0.05020576323525583,
                "sharpe0": -0.05539939667237259
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.30000000000000004,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.032546204397490355,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.22103133695731536,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645635751858532,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.13643035188582556,
                "exit_cost_total": 0.2132304980436964,
                "cost_paid_total": 0.349660849929522,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 10.25946176810861,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.21954747760122828,
                "vol_ann": 0.20364596832478124,
                "sharpe0": 1.076923796180648,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.36211707825789985,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6062886585118931,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.015805974355440844,
                "mdd": -0.02384060553413836,
                "sharpe0": -0.023810535415623058
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11945171862474324,
              "sharpe0": 0.534966602402027,
              "mdd": -0.3083008551920855,
              "calmar": 0.38745179136891905
            },
            "post": {
              "cagr": 0.21954747760122828,
              "sharpe0": 1.076923796180648,
              "mdd": -0.36211707825789985,
              "calmar": 0.6062886585118931
            },
            "delta_post_minus_pre": {
              "cagr": 0.10009575897648504,
              "sharpe0": 0.541957193778621,
              "mdd": -0.05381622306581435,
              "calmar": 0.218836867142974
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.21954747760122828,
            "mdd": -0.36211707825789985,
            "sharpe0": 1.076923796180648
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.015805974355440844,
            "sharpe0": -0.023810535415623058
          },
          "delta_abs_mdd": 0.02384060553413836
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394142917471746)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.06394142917471746)",
        "full: equity_negative_days>0 (neg_days=124)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.3x.csv"
    },
    {
      "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
      "ok": true,
      "generated_at_utc": "2026-02-26T08:29:15Z",
      "schema_version": "v26.9",
      "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
      "params": {
        "bb_window": 60,
        "bb_ddof": 0,
        "entry_z": -1.5,
        "exit_z": 0.0,
        "leverage_frac": 0.5,
        "borrow_apr": 0.035,
        "max_hold_days": 60,
        "trading_days": 252,
        "skip_contaminated": true,
        "contam_horizon": 60,
        "z_clear_days": 60,
        "fee_rate": 0.001425,
        "tax_rate": 0.001,
        "slip_bps": 5.0,
        "cost_on": "lever",
        "entry_mode": "trend",
        "trend_rule": "price_gt_ma60",
        "trend_ma_fast": 20,
        "trend_ma_slow": 60,
        "perf_ddof": 0,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional"
      },
      "audit": {
        "rows": 4196,
        "start_date": "2009-01-02",
        "end_date": "2026-02-26",
        "base_price_t0": 20.467863082885746,
        "base_shares": 0.04885707882402988,
        "lever_shares_target": 0.02442853941201494,
        "bb_z_non_nan": 4137,
        "bb_z_first_valid_date": "2009-04-07",
        "interest_paid_total": 0.20762512688382054,
        "trades": 94,
        "skipped_entries_on_forbidden": 0,
        "skipped_entries_on_nonpositive_equity": 912,
        "skipped_entries_same_day_exit": 12,
        "skipped_entries_on_rv20": 0,
        "rv20_filter": {
          "enabled": true,
          "scope": "bb_entry_only",
          "rv20_window": 20,
          "rv20_annualization_trading_days": 252,
          "q_lookback": 252,
          "q": 0.6,
          "q_min_periods": 100,
          "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
          "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
        },
        "equity_negative_days": 1422,
        "equity_min": -0.39616201036035165,
        "open_at_end": true,
        "forced_eod_close": 1,
        "exit_count_by_exit_z": 0,
        "exit_count_by_max_hold_days": 12,
        "exit_count_by_trend_off": 81,
        "exit_count_by_end_of_data": 1,
        "margin_call_count": 0,
        "min_maintenance_ratio": null,
        "maintenance_margin": 0.0,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
        "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
        "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
        "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
        "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
        "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
        "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
        "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
        "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
        "costs_enabled": true,
        "cost_on": "lever",
        "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
        "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
        "entry_cost_total": 0.14887398429604545,
        "exit_cost_total": 0.2287186550006033,
        "cost_paid_total": 0.3775926392966488,
        "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price"
      },
      "perf": {
        "leverage": {
          "ok": true,
          "start": 1.0,
          "end": 4.23681152171341,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.09060426204151684,
          "vol_ann": 8.830809375986663,
          "sharpe0": -0.1946018268758021,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -1.188833014235557,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": "equity went negative; mdd < -1.0 is arithmetically valid but may be misleading"
        },
        "base_only": {
          "ok": true,
          "start": 1.0,
          "end": 3.9647520211200105,
          "n_days": 4196,
          "years": 16.646825396825395,
          "cagr": 0.08626488949345568,
          "vol_ann": 0.28121531561823027,
          "sharpe0": 0.5108341118889853,
          "sharpe_note": "rf=0 assumed",
          "perf_ddof": 0,
          "mdd": -0.773359061194639,
          "mdd_peak": "2011-01-28",
          "mdd_trough": "2014-02-05",
          "mdd_warning": null
        },
        "calmar_leverage": 0.07621277417146526,
        "calmar_base_only": 0.11154571507858047,
        "turnover_proxy": 0.044804575786463297,
        "delta_vs_base": {
          "cagr": 0.00433937254806116,
          "mdd": -0.41547395304091794,
          "sharpe0": -0.7054359387647874
        }
      },
      "segmentation": {
        "enabled": true,
        "mode": "auto_break_rank",
        "split_date": "2014-01-02",
        "post_start_date": "2014-01-03",
        "post_start_policy": "next_row_after_split_date (exclude split day)",
        "break_rank": 0,
        "notes": "Each segment equity is normalized to 1.0 at its own start (base_shares=1/segment_first_price). Segment results are NOT chainable into a single continuous equity curve. v26.8 default: split_date is excluded from BOTH pre and post (post starts at next trading row), unless you override --segment_post_start_date.",
        "segments": {
          "pre": {
            "segment": {
              "name": "pre",
              "rows_raw": 1238,
              "rows_clean": 1238,
              "start_date": "2009-01-02",
              "end_date": "2013-12-31",
              "first_price": 20.467863082885746
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 1238,
                "start_date": "2009-01-02",
                "end_date": "2013-12-31",
                "base_price_t0": 20.467863082885746,
                "base_shares": 0.04885707882402988,
                "lever_shares_target": 0.02442853941201494,
                "bb_z_non_nan": 1179,
                "bb_z_first_valid_date": "2009-04-07",
                "interest_paid_total": 0.08167259501486288,
                "trades": 47,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 3,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9126864972735671,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 3,
                "exit_count_by_trend_off": 43,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.07583049225472237,
                "exit_cost_total": 0.11559353577304375,
                "cost_paid_total": 0.1914240280277661,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 1.6814584975862366,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.11167153066675617,
                "vol_ann": 0.30168190511837595,
                "sharpe0": 0.5006017695920875,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.33887880155162664,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 1.8278611003298368,
                "n_days": 1238,
                "years": 4.908730158730159,
                "cagr": 0.1307399058791845,
                "vol_ann": 0.268962218290986,
                "sharpe0": 0.5903659990743996,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.25809509195682967,
                "mdd_peak": "2011-01-28",
                "mdd_trough": "2011-12-19",
                "mdd_warning": null
              },
              "calmar_leverage": 0.32953235834004657,
              "calmar_base_only": 0.5065571177194362,
              "turnover_proxy": 0.07592891760904685,
              "delta_vs_base": {
                "cagr": -0.019068375212428323,
                "mdd": -0.08078370959479697,
                "sharpe0": -0.08976422948231211
              }
            }
          },
          "post": {
            "segment": {
              "name": "post",
              "rows_raw": 2957,
              "rows_clean": 2957,
              "start_date": "2014-01-03",
              "end_date": "2026-02-26",
              "first_price": 9.21766471862793
            },
            "ok": true,
            "summary": {
              "generated_at_utc": "2026-02-26T08:29:15Z",
              "schema_version": "v26.9",
              "script_fingerprint": "backtest_tw0050_leverage_mvp@2026-02-24.v26.9.cleanup_equity_curve_csvs",
              "params": {
                "bb_window": 60,
                "bb_ddof": 0,
                "entry_z": -1.5,
                "exit_z": 0.0,
                "leverage_frac": 0.5,
                "borrow_apr": 0.035,
                "max_hold_days": 60,
                "trading_days": 252,
                "skip_contaminated": true,
                "contam_horizon": 60,
                "z_clear_days": 60,
                "fee_rate": 0.001425,
                "tax_rate": 0.001,
                "slip_bps": 5.0,
                "cost_on": "lever",
                "entry_mode": "trend",
                "trend_rule": "price_gt_ma60",
                "trend_ma_fast": 20,
                "trend_ma_slow": 60,
                "perf_ddof": 0,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional"
              },
              "audit": {
                "rows": 2957,
                "start_date": "2014-01-03",
                "end_date": "2026-02-26",
                "base_price_t0": 9.21766471862793,
                "base_shares": 0.10848734799163451,
                "lever_shares_target": 0.054243673995817254,
                "bb_z_non_nan": 2898,
                "bb_z_first_valid_date": "2014-04-08",
                "interest_paid_total": 0.3683855615955317,
                "trades": 92,
                "skipped_entries_on_forbidden": 0,
                "skipped_entries_on_nonpositive_equity": 0,
                "skipped_entries_same_day_exit": 15,
                "skipped_entries_on_rv20": 0,
                "rv20_filter": {
                  "enabled": true,
                  "scope": "bb_entry_only",
                  "rv20_window": 20,
                  "rv20_annualization_trading_days": 252,
                  "q_lookback": 252,
                  "q": 0.6,
                  "q_min_periods": 100,
                  "block_rule": "block entry when isfinite(rv20) & isfinite(q60) & rv20 > q60; else allow",
                  "note": "This is a defensive filter to avoid opening leverage in elevated realized vol regimes."
                },
                "equity_negative_days": 0,
                "equity_min": 0.9645635751858532,
                "open_at_end": true,
                "forced_eod_close": 1,
                "exit_count_by_exit_z": 0,
                "exit_count_by_max_hold_days": 15,
                "exit_count_by_trend_off": 76,
                "exit_count_by_end_of_data": 1,
                "margin_call_count": 0,
                "min_maintenance_ratio": null,
                "maintenance_margin": 0.0,
                "maint_ratio_mode": "equity_over_lever_notional",
                "maintenance_ratio_semantics": "maint_ratio = equity / (lever_shares*price) (account equity vs lever leg notional; v26 default)",
                "maintenance_margin_interest_order": "Interest accrues at start of bar BEFORE maintenance check; margin_call decision uses post-interest cash/equity for that date.",
                "hold_days_semantics": "entry day sets hold_days=0; increments by 1 each subsequent row while in position",
                "hold_days_exit_recording": "normal exit records hold_days after increment (>=1 on first exit day); margin_call also records hold_days+1 on trigger day for consistency (v26.2).",
                "same_day_reentry": "blocked (exited_today flag); entry is skipped on the same bar after any exit",
                "interest_semantics": "row-based accrual while in position; charged before exit on the exit date; timing assumption: close at end-of-day on exit date",
                "timing_assumption": "assume close-at-EOD on exit date; interest charged for that day before exit",
                "end_of_data_policy": "if open position exists at end, force-close and record trade with exit_reason=end_of_data",
                "lever_leg_pnl_semantics": "gross PnL for leverage leg (proceeds - principal); net_after_costs = lever_leg_pnl - interest_paid - cost_paid",
                "costs_enabled": true,
                "cost_on": "lever",
                "cost_on_semantics": "cost_on='lever' charges costs on lever leg notional only. cost_on='all' charges costs on (base+lever) notional for entry/exit as a conservative upper bound; base leg is held (not liquidated) but still counted in cost_on='all'.",
                "slippage_model": "cash penalty = notional * slip_rate per side; slip_rate = slip_bps * 1e-4",
                "entry_cost_total": 0.2273839198097093,
                "exit_cost_total": 0.35538416340616064,
                "cost_paid_total": 0.58276808321587,
                "leverage_definition": "lever_shares_target = base_shares(t0) * leverage_frac; not rebalanced => effective leverage drifts with price",
                "breaks_detected": 0,
                "break_samples_first5": [],
                "break_samples_source": "detect_breaks_from_price(segment)",
                "forbid_mask_applied": false,
                "forbid_mask_semantics": "for each break idx b: forbid entry i in [b-contam_horizon, b+z_clear_days-1]",
                "forbid_mask_scope_note": "applies forbid mask ONLY when entry_mode == 'bb'",
                "segment_min_rows_mult": 3.0,
                "segment_min_rows": 180
              },
              "perf_leverage": {
                "ok": true,
                "start": 1.0,
                "end": 11.229937310141205,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.22898058717591674,
                "vol_ann": 0.2176246579255979,
                "sharpe0": 1.0567278263898268,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3764663758211697,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "perf_base_only": {
                "ok": true,
                "start": 1.0,
                "end": 8.803748455059695,
                "n_days": 2957,
                "years": 11.73015873015873,
                "cagr": 0.20374150324578744,
                "vol_ann": 0.18390522972646445,
                "sharpe0": 1.100734331596271,
                "sharpe_note": "rf=0 assumed",
                "perf_ddof": 0,
                "mdd": -0.3382764727237615,
                "mdd_peak": "2022-01-17",
                "mdd_trough": "2022-10-25",
                "mdd_warning": null
              },
              "calmar_leverage": 0.6082364903809838,
              "calmar_base_only": 0.6022928570978802,
              "turnover_proxy": 0.06222522827189719,
              "delta_vs_base": {
                "cagr": 0.025239083930129302,
                "mdd": -0.03818990309740822,
                "sharpe0": -0.044006505206444224
              }
            }
          }
        },
        "compare": {
          "ok": true,
          "basis": "post_minus_pre",
          "metrics": {
            "pre": {
              "cagr": 0.11167153066675617,
              "sharpe0": 0.5006017695920875,
              "mdd": -0.33887880155162664,
              "calmar": 0.32953235834004657
            },
            "post": {
              "cagr": 0.22898058717591674,
              "sharpe0": 1.0567278263898268,
              "mdd": -0.3764663758211697,
              "calmar": 0.6082364903809838
            },
            "delta_post_minus_pre": {
              "cagr": 0.11730905650916057,
              "sharpe0": 0.5561260567977393,
              "mdd": -0.03758757426954307,
              "calmar": 0.27870413204093725
            }
          },
          "notes": [
            "Segments are normalized independently (equity starts at 1.0 in each segment).",
            "Compare block is a summary delta, not a continuous equity backtest across split."
          ]
        },
        "compare_error": null,
        "compute_cost_note": "Per strategy: full + pre + post backtests (3x). Not optimized."
      },
      "post_gonogo": {
        "rule_id": "post_gonogo_v3",
        "applies": true,
        "ok": true,
        "decision": "GO_OR_REVIEW",
        "interpretation": {
          "NO_GO": "All three post conditions met: stop / do not deploy / do not tune further.",
          "GO_OR_REVIEW": "Stop rule NOT triggered. This is NOT a PASS. It only means the specific immediate stop rule did not fire."
        },
        "inputs": {
          "post_leverage": {
            "cagr": 0.22898058717591674,
            "mdd": -0.3764663758211697,
            "sharpe0": 1.0567278263898268
          },
          "post_base_only": {
            "cagr": 0.20374150324578744,
            "mdd": -0.3382764727237615,
            "sharpe0": 1.100734331596271
          },
          "delta_vs_base": {
            "cagr": 0.025239083930129302,
            "sharpe0": -0.044006505206444224
          },
          "delta_abs_mdd": 0.03818990309740822
        },
        "reasons": [
          "delta_cagr not below threshold"
        ],
        "thresholds": {
          "delta_sharpe0_lt": 0.0,
          "delta_abs_mdd_gt": 0.0,
          "delta_cagr_lt": 0.01,
          "rationale": "stop rule: leverage must not degrade sharpe, must not worsen drawdown, and must add >=1% CAGR vs base in post segment"
        },
        "conditions": {
          "delta_sharpe0_lt_0.0": true,
          "delta_abs_mdd_gt_0.0": true,
          "delta_cagr_lt_0.01": false
        }
      },
      "forbid_mask_scope": "bb_only",
      "forbid_mask_applied": false,
      "hard_fail": true,
      "hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.39616201036035165)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "suite_hard_fail": true,
      "suite_hard_fail_reasons": [
        "full: equity_min<= 0.0 (equity_min=-0.39616201036035165)",
        "full: equity_negative_days>0 (neg_days=1422)"
      ],
      "equity_curve_csv": "equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv",
      "equity_curve_csv_resolved": "tw0050_bb_cache/equity_curve.0d3098298f__trend_leverage_price_gt_ma60_1.5x.csv"
    }
  ],
  "compare": {
    "rows": [
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.2x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.08796155187524146,
        "full_mdd": -0.9486372986943259,
        "full_sharpe0": 0.6108185484213317,
        "full_calmar": 0.09272411278399967,
        "full_turnover_proxy": 0.06625357483317446,
        "full_delta_cagr_vs_base": 0.001696662381785785,
        "full_delta_mdd_vs_base": -0.17527823749968685,
        "full_delta_sharpe0_vs_base": 0.09998443653234634,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.21452050072217044,
        "post_mdd": -0.3544982219643733,
        "post_sharpe0": 1.0861566143838597,
        "post_calmar": 0.6051384391533832,
        "post_delta_cagr_vs_base": 0.010778997476383001,
        "post_delta_sharpe0_vs_base": -0.0145777172124113,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.1x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.08711839962044676,
        "full_mdd": -0.8626254613147566,
        "full_sharpe0": 0.5405317728028437,
        "full_calmar": 0.10099214957980335,
        "full_turnover_proxy": 0.06625357483317446,
        "full_delta_cagr_vs_base": 0.0008535101269910861,
        "full_delta_mdd_vs_base": -0.08926640012011755,
        "full_delta_sharpe0_vs_base": 0.029697660913858392,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.20925983060259146,
        "post_mdd": -0.34655826556382774,
        "post_sharpe0": 1.0942837920093136,
        "post_calmar": 0.6038229394475395,
        "post_delta_cagr_vs_base": 0.00551832735680402,
        "post_delta_sharpe0_vs_base": -0.0064505395869574045,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.1x",
        "entry_mode": "always",
        "leverage_multiplier": 1.1,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.08873777046223053,
        "full_mdd": -0.836444667330783,
        "full_sharpe0": 0.528345570979159,
        "full_calmar": 0.10608922972203971,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.0024728809687748488,
        "full_delta_mdd_vs_base": -0.063085606136144,
        "full_delta_sharpe0_vs_base": 0.01751145909017371,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.21075675928856707,
        "post_mdd": -0.3551952301451109,
        "post_sharpe0": 1.0768390375956822,
        "post_calmar": 0.5933547001812632,
        "post_delta_cagr_vs_base": 0.0070152560427796384,
        "post_delta_sharpe0_vs_base": -0.023895294000588763,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.2x",
        "entry_mode": "always",
        "leverage_multiplier": 1.2,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.09112667779667927,
        "full_mdd": -0.8953441191618263,
        "full_sharpe0": 0.5578271601642126,
        "full_calmar": 0.101778384250725,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.004861788303223591,
        "full_delta_mdd_vs_base": -0.12198505796718728,
        "full_delta_sharpe0_vs_base": 0.04699304827522732,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.21736371277611255,
        "post_mdd": -0.3705351312766605,
        "post_sharpe0": 1.0567642180006074,
        "post_calmar": 0.5866210635067088,
        "post_delta_cagr_vs_base": 0.013622209530325113,
        "post_delta_sharpe0_vs_base": -0.04397011359566361,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.3x",
        "entry_mode": "always",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.09343732531087023,
        "full_mdd": -0.950460705469819,
        "full_sharpe0": 0.6068223682663821,
        "full_calmar": 0.09830740479132544,
        "full_turnover_proxy": 0.032650142993326976,
        "full_delta_cagr_vs_base": 0.0071724358174145575,
        "full_delta_mdd_vs_base": -0.17710164427517994,
        "full_delta_sharpe0_vs_base": 0.09598825637739683,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.22360930244462063,
        "post_mdd": -0.38450733161831985,
        "post_sharpe0": 1.03966050510904,
        "post_calmar": 0.5815475650450946,
        "post_delta_cagr_vs_base": 0.01986779919883319,
        "post_delta_sharpe0_vs_base": -0.06107382648723103,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "bb_conditional",
        "entry_mode": "bb",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.0879236435079922,
        "full_mdd": -0.7142132404752984,
        "full_sharpe0": 0.4993774934310797,
        "full_calmar": 0.12310559161502005,
        "full_turnover_proxy": 0.010486177311725452,
        "full_delta_cagr_vs_base": 0.0016587540145365232,
        "full_delta_mdd_vs_base": 0.0591458207193406,
        "full_delta_sharpe0_vs_base": -0.011456618457905632,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.20312556257399805,
        "post_mdd": -0.4136536180783389,
        "post_sharpe0": 0.9927222607200273,
        "post_calmar": 0.49105230486713536,
        "post_delta_cagr_vs_base": -0.0006159406717893834,
        "post_delta_sharpe0_vs_base": -0.10801207087624365,
        "post_gonogo": "NO_GO",
        "rank_basis": "post",
        "hard_fail": false,
        "suite_hard_fail": false,
        "hard_fail_reason": null,
        "ok": true
      },
      {
        "strategy_id": "always_leverage_1.5x",
        "entry_mode": "always",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.0984979990564947,
        "full_mdd": -1.0507150526581386,
        "full_sharpe0": -0.19689933937204032,
        "full_calmar": 0.09374377839863506,
        "full_turnover_proxy": 0.030743565300285988,
        "full_delta_cagr_vs_base": 0.012233109563039024,
        "full_delta_mdd_vs_base": -0.27735599146349954,
        "full_delta_sharpe0_vs_base": -0.7077334512610256,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.23516702000443623,
        "post_mdd": -0.40902039795450595,
        "post_sharpe0": 1.0120696247359402,
        "post_calmar": 0.5749518145806339,
        "post_delta_cagr_vs_base": 0.0314255167586488,
        "post_delta_sharpe0_vs_base": -0.08866470686033079,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.11447374811936006); full: equity_negative_days>0 (neg_days=422)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.3x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.3,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.08870497106894293,
        "full_mdd": -1.0315693739101066,
        "full_sharpe0": -0.03005977951874861,
        "full_calmar": 0.08599031079481513,
        "full_turnover_proxy": 0.0657769304099142,
        "full_delta_cagr_vs_base": 0.002440081575487252,
        "full_delta_mdd_vs_base": -0.25821031271546757,
        "full_delta_sharpe0_vs_base": -0.5408938914077339,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.21954747760122828,
        "post_mdd": -0.36211707825789985,
        "post_sharpe0": 1.076923796180648,
        "post_calmar": 0.6062886585118931,
        "post_delta_cagr_vs_base": 0.015805974355440844,
        "post_delta_sharpe0_vs_base": -0.023810535415623058,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.06394142917471746); full: equity_negative_days>0 (neg_days=124)",
        "ok": true
      },
      {
        "strategy_id": "trend_leverage_price_gt_ma60_1.5x",
        "entry_mode": "trend",
        "leverage_multiplier": 1.5,
        "maint_ratio_mode": "equity_over_lever_notional",
        "maintenance_margin": 0.0,
        "full_base_price_t0": 20.467863082885746,
        "full_cagr": 0.09060426204151684,
        "full_mdd": -1.188833014235557,
        "full_sharpe0": -0.1946018268758021,
        "full_calmar": 0.07621277417146526,
        "full_turnover_proxy": 0.044804575786463297,
        "full_delta_cagr_vs_base": 0.00433937254806116,
        "full_delta_mdd_vs_base": -0.41547395304091794,
        "full_delta_sharpe0_vs_base": -0.7054359387647874,
        "post_ok": true,
        "post_segment_start_price": 9.21766471862793,
        "post_cagr": 0.22898058717591674,
        "post_mdd": -0.3764663758211697,
        "post_sharpe0": 1.0567278263898268,
        "post_calmar": 0.6082364903809838,
        "post_delta_cagr_vs_base": 0.025239083930129302,
        "post_delta_sharpe0_vs_base": -0.044006505206444224,
        "post_gonogo": "GO_OR_REVIEW",
        "rank_basis": "post",
        "hard_fail": true,
        "suite_hard_fail": true,
        "hard_fail_reason": "full: equity_min<= 0.0 (equity_min=-0.39616201036035165); full: equity_negative_days>0 (neg_days=1422)",
        "ok": true
      }
    ],
    "ranking_policy": "prefer post (calmar desc, sharpe0 desc) when post_ok=true; else fallback to full; EXCLUDE hard_fail",
    "top3_by_policy": [
      "trend_leverage_price_gt_ma60_1.2x",
      "trend_leverage_price_gt_ma60_1.1x",
      "always_leverage_1.1x"
    ]
  },
  "failed_strategies": [],
  "suite_ok": true,
  "abort_reason": null,
  "outputs": {
    "export_strategy_id": "trend_leverage_price_gt_ma60_1.2x",
    "export_policy": "top1_by_compare_policy else first_success"
  },
  "notes": [
    "Hard-fail strategies are excluded from ranking.",
    "Maintenance margin forced close approximates margin call at EOD on trigger bar; intraday is not modeled.",
    "Maintenance ratio thresholds are NOT interchangeable across maint_ratio_mode values.",
    "JSON output is sanitized: NaN/Inf are converted to null; allow_nan=False enforced.",
    "v26.5+: RV20 entry filter is enabled for BB mode (defensive).",
    "v26.6: hard_fail scope='post' still enforces full_floor.",
    "v26.7+: write per-strategy equity curve CSV for renderer evidence.",
    "v26.8: default post_start_date excludes split_date (cut singularity day from segment stats).",
    "v26.9: cleanup old equity_curve.*.csv files in cache_dir at start of run."
  ]
}